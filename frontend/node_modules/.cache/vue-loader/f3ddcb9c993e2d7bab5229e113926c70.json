{"remainingRequest":"/Users/philippwegner/Desktop/Fraunhofer/SEM-Group/git/github/data-steward/frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/philippwegner/Desktop/Fraunhofer/SEM-Group/git/github/data-steward/frontend/src/components/DataModelGraph.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/philippwegner/Desktop/Fraunhofer/SEM-Group/git/github/data-steward/frontend/src/components/DataModelGraph.vue","mtime":1635322962953},{"path":"/Users/philippwegner/Desktop/Fraunhofer/SEM-Group/git/github/data-steward/frontend/node_modules/cache-loader/dist/cjs.js","mtime":1635508076994},{"path":"/Users/philippwegner/Desktop/Fraunhofer/SEM-Group/git/github/data-steward/frontend/node_modules/thread-loader/dist/cjs.js","mtime":1635508076954},{"path":"/Users/philippwegner/Desktop/Fraunhofer/SEM-Group/git/github/data-steward/frontend/node_modules/babel-loader/lib/index.js","mtime":1635508077568},{"path":"/Users/philippwegner/Desktop/Fraunhofer/SEM-Group/git/github/data-steward/frontend/node_modules/cache-loader/dist/cjs.js","mtime":1635508076994},{"path":"/Users/philippwegner/Desktop/Fraunhofer/SEM-Group/git/github/data-steward/frontend/node_modules/vue-loader/lib/index.js","mtime":1635508077737}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBheCBmcm9tICJheGlvcyI7CmNvbnN0IGF4aW9zID0gYXg7CmltcG9ydCBNIGZyb20gIm1hdGVyaWFsaXplLWNzcyI7CgpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogImdyYXBoIiwKICBtZXRob2RzOiB7CiAgICBoaWRlTmF2OiBmdW5jdGlvbigpewogICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgidG9wX25hdl9kaXYiKS5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiOyAKICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImhpZGVOYXZCdG4iKS5jbGFzc0xpc3QuYWRkKCJoaWRlIik7CiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJzaG93TmF2QnRuIikuY2xhc3NMaXN0LnJlbW92ZSgiaGlkZSIpOwoKICAgIH0sCiAgICBzaG93TmF2OiBmdW5jdGlvbigpewogICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgidG9wX25hdl9kaXYiKS5zdHlsZS5kaXNwbGF5ID0gImZsZXgiOwogICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgic2hvd05hdkJ0biIpLmNsYXNzTGlzdC5hZGQoImhpZGUiKTsKICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImhpZGVOYXZCdG4iKS5jbGFzc0xpc3QucmVtb3ZlKCJoaWRlIik7CiAgICB9LAoKICAgIHVzZXJLZXlib2FyZDogZnVuY3Rpb24gKGUpIHsKICAgICAgaWYgKGUua2V5Q29kZSA9PSA3MCAmJiBlLmN0cmxLZXkpIHsKICAgICAgICBhbGVydCgiY3RybCBGIik7CiAgICAgIH0KICAgIH0sCiAgICBjbHVzdGVyQWxsOiBmdW5jdGlvbiAoKSB7CiAgICAgIC8vIENMVVNURVJJTkcgdmlhIFRPUElDUwoKICAgICAgdmFyIG9wdGlvbnNfdG9waWNzID0gW107CiAgICAgIHRoaXMudG9waWNzX2FsbC5mb3JFYWNoKGZ1bmN0aW9uICh0b3BpYykgewogICAgICAgIHZhciBvcHRpb25zX3RvcGljID0gewogICAgICAgICAgam9pbkNvbmRpdGlvbjogZnVuY3Rpb24gKG5vZGVPcHRpb25zKSB7CiAgICAgICAgICAgIC8vY29uc29sZS5sb2coIkhBTExPSEFMTE8iKTsKICAgICAgICAgICAgcmV0dXJuIG5vZGVPcHRpb25zLmNpZCA9PSB0b3BpYzsKICAgICAgICAgIH0sCiAgICAgICAgICBjbHVzdGVyTm9kZVByb3BlcnRpZXM6IHsKICAgICAgICAgICAgaWQ6ICJjaWRDbHVzdGVyXyIgKyB0b3BpYywKICAgICAgICAgICAgYm9yZGVyV2lkdGg6IDMsCiAgICAgICAgICAgIHNoYXBlOiAic3F1YXJlIiwKCiAgICAgICAgICAgIGxhYmVsOiB0b3BpYywKICAgICAgICAgIH0sCiAgICAgICAgfTsKICAgICAgICBvcHRpb25zX3RvcGljcy5wdXNoKG9wdGlvbnNfdG9waWMpOwogICAgICAgIC8vIGNvbnNvbGUubG9nKHRvcGljICsgIiBjbHVzdGVyaW5nLi4uIik7CiAgICAgICAgLy8gdGhpcy4kcmVmcy5uZXR3b3JrLmNsdXN0ZXIob3B0aW9uc190b3BpYyk7CiAgICAgIH0pOwogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG9wdGlvbnNfdG9waWNzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgdGhpcy4kcmVmcy5uZXR3b3JrLmNsdXN0ZXIob3B0aW9uc190b3BpY3NbaV0pOwogICAgICB9CgogICAgICAvLyBDTFVTVEVSSU5HIHZpYSBTT1VSQ0VTCgogICAgICB2YXIgb3B0aW9uc19zb3VyY2VzID0gW107CiAgICAgIHRoaXMuc291cmNlc19hbGwuZm9yRWFjaChmdW5jdGlvbiAoc291cmNlKSB7CiAgICAgICAgdmFyIG9wdGlvbnNfc291cmNlID0gewogICAgICAgICAgam9pbkNvbmRpdGlvbjogZnVuY3Rpb24gKG5vZGVPcHRpb25zKSB7CiAgICAgICAgICAgIC8vY29uc29sZS5sb2coIkhBTExPSEFMTE8iKTsKICAgICAgICAgICAgcmV0dXJuIG5vZGVPcHRpb25zLmNpZCA9PSBzb3VyY2U7CiAgICAgICAgICB9LAogICAgICAgICAgY2x1c3Rlck5vZGVQcm9wZXJ0aWVzOiB7CiAgICAgICAgICAgIGlkOiAiY2lkQ2x1c3Rlcl8iICsgc291cmNlLAogICAgICAgICAgICBib3JkZXJXaWR0aDogMywKICAgICAgICAgICAgc2hhcGU6ICJzcXVhcmUiLAogICAgICAgICAgICBsYWJlbDogc291cmNlLAogICAgICAgICAgICBjb2xvcjogewogICAgICAgICAgICAgIGJhY2tncm91bmQ6ICIjYzJhZDRiIiwKICAgICAgICAgICAgICBib3JkZXI6ICIjYzJhZDRiIgogICAgICAgICAgICB9LAogICAgICAgICAgfSwKICAgICAgICB9OwogICAgICAgIG9wdGlvbnNfc291cmNlcy5wdXNoKG9wdGlvbnNfc291cmNlKTsKICAgICAgICAvLyBjb25zb2xlLmxvZyh0b3BpYyArICIgY2x1c3RlcmluZy4uLiIpOwogICAgICAgIC8vIHRoaXMuJHJlZnMubmV0d29yay5jbHVzdGVyKG9wdGlvbnNfdG9waWMpOwogICAgICB9KTsKICAgICAgZm9yICh2YXIgcCA9IDA7IHAgPCBvcHRpb25zX3NvdXJjZXMubGVuZ3RoOyBwKyspIHsKICAgICAgICB0aGlzLiRyZWZzLm5ldHdvcmsuY2x1c3RlcihvcHRpb25zX3NvdXJjZXNbcF0pOwogICAgICB9CiAgICB9LAogICAgZ2VuZXJhbENsaWNrOiBmdW5jdGlvbiAoKSB7CiAgICAgIGNvbnN0IG1lbnUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgicmlnaHRDbGlja01lbnUiKTsKICAgICAgaWYgKG1lbnUuc3R5bGUuZGlzcGxheSA9PSAiYmxvY2siKSB7CiAgICAgICAgbWVudS5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiOwogICAgICB9CiAgICB9LAogICAgb25Db250ZXh0Q2xpY2tTdWI6IGZ1bmN0aW9uIChwYXJhbXMpIHsKICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInJpZ2h0TWVudUxpc3QiKS5pbm5lckhUTUwgPSAiIjsKICAgICAgaWYgKHBhcmFtcy5ub2Rlcy5sZW5ndGggPT0gMSkgewogICAgICAgIGNvbnN0IGUgPSBwYXJhbXMuZXZlbnQ7CiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwoKICAgICAgICBjb25zdCBtZW51ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInJpZ2h0Q2xpY2tNZW51Iik7CiAgICAgICAgdmFyIHBhZ2V4ID0gZS5wYWdlWDsKICAgICAgICB2YXIgcGFnZXkgPSBlLnBhZ2VZOwogICAgICAgIG1lbnUuc3R5bGUubGVmdCA9IGAke3BhZ2V4fXB4YDsKICAgICAgICBtZW51LnN0eWxlLnRvcCA9IGAke3BhZ2V5fXB4YDsKICAgICAgICBtZW51LnN0eWxlLmRpc3BsYXkgPSAiYmxvY2siOwogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJyaWdodE1lbnVMaXN0IikuaW5uZXJIVE1MID0gIiI7CgogICAgICAgIGlmICh0aGlzLiRyZWZzLm5ldHdvcmsuaXNDbHVzdGVyKHBhcmFtcy5ub2Rlc1swXSkpIHsKICAgICAgICAgIGNvbnNvbGUuZXJyb3IoImNsdXN0ZXIgb2NjdXJlZCBpbiBzdWIgZ3JhcGguLi4iKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgWyJJbnNwZWN0IiwgIlNob3cgbW9yZSBpbiBPTFMiXS5mb3JFYWNoKChzKSA9PiB7CiAgICAgICAgICAgIHZhciBsaXN0ZWxlbU5vZGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJsaSIpOwogICAgICAgICAgICBsaXN0ZWxlbU5vZGUuY2xhc3NMaXN0LmFkZCgibWVudS1vcHRpb24iKTsKICAgICAgICAgICAgdmFyIGJ0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImJ1dHRvbiIpOwogICAgICAgICAgICBidG4uY2xhc3NMaXN0LmFkZCgiYnRuIik7CiAgICAgICAgICAgIGJ0bi5jbGFzc0xpc3QuYWRkKCJ3YXZlcy1lZmZlY3QiKTsKICAgICAgICAgICAgYnRuLmNsYXNzTGlzdC5hZGQoImJsdWUtZ3JleSIsICJsaWdodGVuLTEiKTsKICAgICAgICAgICAgYnRuLnN0eWxlLmhlaWdodCA9ICJhdXRvIjsKICAgICAgICAgICAgYnRuLnN0eWxlLndpZHRoID0gImF1dG8iOwogICAgICAgICAgICBidG4uc3R5bGUubWFyZ2luID0gIjJweCI7CiAgICAgICAgICAgIHZhciB0ZXh0Tm9kZSA9IGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKHMpOwogICAgICAgICAgICBpZiAocyA9PSAiSW5zcGVjdCIpIHsKICAgICAgICAgICAgICBidG4ub25jbGljayA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgIHZhciBnZXRQYXJhbXMgPSB7fTsKICAgICAgICAgICAgICAgIGlmIChwYXJhbXMubm9kZXNbMF0uc3RhcnRzV2l0aCgiYXR0cl8iKSkgewogICAgICAgICAgICAgICAgICBnZXRQYXJhbXNbInR5cGUiXSA9ICJhdHRyaWJ1dGUiOwogICAgICAgICAgICAgICAgICBnZXRQYXJhbXNbIm5vZGUiXSA9IHBhcmFtcy5ub2Rlc1swXS5yZXBsYWNlKCJhdHRyXyIsICIiKTsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocGFyYW1zLm5vZGVzWzBdLnN0YXJ0c1dpdGgoInNvdXJjZXNfIikpIHsKICAgICAgICAgICAgICAgICAgZ2V0UGFyYW1zWyJ0eXBlIl0gPSAic291cmNlIjsKICAgICAgICAgICAgICAgICAgZ2V0UGFyYW1zWyJub2RlIl0gPSBwYXJhbXMubm9kZXNbMF0ucmVwbGFjZSgic291cmNlc18iLCAiIik7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICBnZXRQYXJhbXNbInR5cGUiXSA9ICJjb3JlIjsKICAgICAgICAgICAgICAgICAgZ2V0UGFyYW1zWyJub2RlIl0gPSBwYXJhbXMubm9kZXNbMF07CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBjb25zdCBhdHRyaWJ1dGVJbmZvcm1hdGlvbiA9IGF4aW9zLmdldCgKICAgICAgICAgICAgICAgICAgcHJvY2Vzcy5lbnYuVlVFX0FQUF9DTElOSUNBTFVSTCArICIvZ2V0L2F0dHJpYnV0ZSIsCiAgICAgICAgICAgICAgICAgIHsgcGFyYW1zOiBnZXRQYXJhbXMgfQogICAgICAgICAgICAgICAgKTsKCiAgICAgICAgICAgICAgICBhdHRyaWJ1dGVJbmZvcm1hdGlvbi50aGVuKChkYXRhKSA9PiB7CiAgICAgICAgICAgICAgICAgIHZhciBlbGVtID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIm1vZGFsMSIpOwogICAgICAgICAgICAgICAgICB2YXIgaW5zdGFuY2UgPSBNLk1vZGFsLmdldEluc3RhbmNlKGVsZW0pOwogICAgICAgICAgICAgICAgICB2YXIgbW9kYWxIZWFkZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiaGVhZGVyTW9kYWwiKTsKCiAgICAgICAgICAgICAgICAgIG1vZGFsSGVhZGVyLnRleHRDb250ZW50ID0KICAgICAgICAgICAgICAgICAgICAiVmFyaWFibGUgTmFtZTogIiArIGdldFBhcmFtc1sibm9kZSJdOwogICAgICAgICAgICAgICAgICB2YXIgbW9kYWxUZXh0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInRleHRNb2RhbCIpOwogICAgICAgICAgICAgICAgICBtb2RhbFRleHQuaW5uZXJIVE1MID0gIiI7CgogICAgICAgICAgICAgICAgICBpZiAoZGF0YVsiZGF0YSJdWyJpbmZvcm1hdGlvbiJdID09ICJub25lIikgewogICAgICAgICAgICAgICAgICAgIG1vZGFsVGV4dC5hcHBlbmRDaGlsZCgKICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKAogICAgICAgICAgICAgICAgICAgICAgICAiTm8gaW5mb3JtYXRpb24gYXZhaWxhYmxlIGluIENsaW5pY2FsIEJhY2tlbmQuLi4iCiAgICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgICAgICBtZW51LnN0eWxlLmRpc3BsYXkgPSAibm9uZSI7CiAgICAgICAgICAgICAgICAgICAgaW5zdGFuY2Uub3BlbigpOwogICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIHZhciBkYXRhX2FzX2pzb24gPSBKU09OLnBhcnNlKAogICAgICAgICAgICAgICAgICAgICAgZGF0YVsiZGF0YSJdWyJpbmZvcm1hdGlvbiJdCiAgICAgICAgICAgICAgICAgICAgKVswXVsiZmllbGRzIl07CgogICAgICAgICAgICAgICAgICAgIHZhciBrZXlzID0gT2JqZWN0LmtleXMoZGF0YV9hc19qc29uKTsKCiAgICAgICAgICAgICAgICAgICAgdmFyIHRibCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoInRhYmxlIik7CiAgICAgICAgICAgICAgICAgICAgdGJsLnN0eWxlLndpZHRoID0gIjEwMCUiOwogICAgICAgICAgICAgICAgICAgIHRibC5zZXRBdHRyaWJ1dGUoImJvcmRlciIsICIxIik7CiAgICAgICAgICAgICAgICAgICAgdmFyIHRiZHkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJ0Ym9keSIpOwogICAgICAgICAgICAgICAgICAgIGtleXMuZm9yRWFjaChmdW5jdGlvbiAodmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICAgIHZhciByb3cgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJ0ciIpOwogICAgICAgICAgICAgICAgICAgICAgdmFyIGNlbGwxID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgidGQiKTsKICAgICAgICAgICAgICAgICAgICAgIHZhciBjZWxsMiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoInRkIik7CiAgICAgICAgICAgICAgICAgICAgICBjZWxsMS5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZSh2YWx1ZSkpOwoKICAgICAgICAgICAgICAgICAgICAgIGNlbGwyLmFwcGVuZENoaWxkKAogICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShkYXRhX2FzX2pzb25bdmFsdWVdKQogICAgICAgICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgICAgICAgIHJvdy5hcHBlbmRDaGlsZChjZWxsMSk7CiAgICAgICAgICAgICAgICAgICAgICByb3cuYXBwZW5kQ2hpbGQoY2VsbDIpOwogICAgICAgICAgICAgICAgICAgICAgdGJkeS5hcHBlbmRDaGlsZChyb3cpOwogICAgICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgICAgICB0YmwuYXBwZW5kQ2hpbGQodGJkeSk7CgogICAgICAgICAgICAgICAgICAgIG1vZGFsVGV4dC5hcHBlbmRDaGlsZCh0YmwpOwogICAgICAgICAgICAgICAgICAgIG1lbnUuc3R5bGUuZGlzcGxheSA9ICJub25lIjsKICAgICAgICAgICAgICAgICAgICBpbnN0YW5jZS5vcGVuKCk7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhhdHRyaWJ1dGVJbmZvcm1hdGlvbik7CiAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAocyA9PSAiU2hvdyBtb3JlIGluIE9MUyIpIHsKICAgICAgICAgICAgICBidG4ub25jbGljayA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgIHdpbmRvdy5vcGVuKAogICAgICAgICAgICAgICAgICBwcm9jZXNzLmVudi5WVUVfQVBQX09MU1VSTCArCiAgICAgICAgICAgICAgICAgICAgInNlYXJjaD9xPSIgKwogICAgICAgICAgICAgICAgICAgIHBhcmFtcy5ub2Rlc1swXS5yZXBsYWNlKCJhdHRyXyIsICIiKSwKICAgICAgICAgICAgICAgICAgInBvcFVwV2luZG93IiwKICAgICAgICAgICAgICAgICAgImhlaWdodD04MDAsd2lkdGg9MTIwMCxsZWZ0PTEwLHRvcD0xMCwsc2Nyb2xsYmFycz15ZXMsbWVudWJhcj1ubyIKICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgYnRuLmFwcGVuZENoaWxkKHRleHROb2RlKTsKICAgICAgICAgICAgbGlzdGVsZW1Ob2RlLmFwcGVuZENoaWxkKGJ0bik7CiAgICAgICAgICAgIG1lbnUuZmlyc3RDaGlsZC5hcHBlbmRDaGlsZChsaXN0ZWxlbU5vZGUpOwogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIGlmIChwYXJhbXMuZWRnZXMubGVuZ3RoID09IDEpIHsKICAgICAgICAgIHZhciBidG4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJidXR0b24iKTsKICAgICAgICAgIHZhciBlZGdlID0gcGFyYW1zLmVkZ2VzWzBdOwogICAgICAgICAgY29uc3QgZSA9IHBhcmFtcy5ldmVudDsKICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTsKCiAgICAgICAgICBjb25zdCBtZW51ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInJpZ2h0Q2xpY2tNZW51Iik7CiAgICAgICAgICBwYWdleCA9IGUucGFnZVg7CiAgICAgICAgICBwYWdleSA9IGUucGFnZVk7CiAgICAgICAgICBtZW51LnN0eWxlLmxlZnQgPSBgJHtwYWdleH1weGA7CiAgICAgICAgICBtZW51LnN0eWxlLnRvcCA9IGAke3BhZ2V5fXB4YDsKICAgICAgICAgIG1lbnUuc3R5bGUuZGlzcGxheSA9ICJibG9jayI7CiAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgicmlnaHRNZW51TGlzdCIpLmlubmVySFRNTCA9ICIiOwogICAgICAgICAgY29uc3QgbmV0dyA9IHRoaXMuJHJlZnMubmV0d29yazsKICAgICAgICAgIHZhciBsaXN0ZWxlbU5vZGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJsaSIpOwogICAgICAgICAgbGlzdGVsZW1Ob2RlLmNsYXNzTGlzdC5hZGQoIm1lbnUtb3B0aW9uIik7CiAgICAgICAgICBidG4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJidXR0b24iKTsKICAgICAgICAgIGJ0bi5jbGFzc0xpc3QuYWRkKCJidG4iKTsKICAgICAgICAgIGJ0bi5jbGFzc0xpc3QuYWRkKCJ3YXZlcy1lZmZlY3QiKTsKICAgICAgICAgIGJ0bi5jbGFzc0xpc3QuYWRkKCJibHVlLWdyZXkiLCAibGlnaHRlbi0xIik7CiAgICAgICAgICBidG4uc3R5bGUuaGVpZ2h0ID0gImF1dG8iOwogICAgICAgICAgYnRuLnN0eWxlLndpZHRoID0gImF1dG8iOwogICAgICAgICAgYnRuLnN0eWxlLm1hcmdpbiA9ICIycHgiOwogICAgICAgICAgdmFyIHMgPSAiSW5zcGVjdCI7CiAgICAgICAgICB2YXIgdGV4dE5vZGUgPSBkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShzICsgIiBFZGdlIik7CiAgICAgICAgICBpZiAocyA9PSAiSW5zcGVjdCIpIHsKICAgICAgICAgICAgYnRuLm9uY2xpY2sgPSBhc3luYyBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgdmFyIGdldFBhcmFtcyA9IHt9OwogICAgICAgICAgICAgIHZhciBjb25uZWN0ZWROb2RlcyA9IG5ldHcuZ2V0Q29ubmVjdGVkTm9kZXMoZWRnZSk7CiAgICAgICAgICAgICAgaWYgKAogICAgICAgICAgICAgICAgY29ubmVjdGVkTm9kZXNbMF0udG9Mb3dlckNhc2UoKS5pbmNsdWRlcygiY2x1c3RlciIpIHx8CiAgICAgICAgICAgICAgICBjb25uZWN0ZWROb2Rlc1sxXS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCJjbHVzdGVyIikKICAgICAgICAgICAgICApIHsKICAgICAgICAgICAgICAgIE0udG9hc3QoewogICAgICAgICAgICAgICAgICBodG1sOiAiUGxlYXNlIE9wZW4gdGhlIGNsdXN0ZXIgYmVmb3JlIGluc3BlY3RpbmcgZWRnZXMhIiwKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBpZiAoCiAgICAgICAgICAgICAgICBjb25uZWN0ZWROb2Rlc1swXS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCJzb3VyY2UiKSB8fAogICAgICAgICAgICAgICAgY29ubmVjdGVkTm9kZXNbMV0udG9Mb3dlckNhc2UoKS5pbmNsdWRlcygic291cmNlIikKICAgICAgICAgICAgICApIHsKICAgICAgICAgICAgICAgIE0udG9hc3QoewogICAgICAgICAgICAgICAgICBodG1sOgogICAgICAgICAgICAgICAgICAgICJNYXBwaW5ncyBvZiB0eXBlICdwYXJ0X29mJyBkbyBub3QgY29udGFpbiBtb3JlIGluZm9ybWF0aW9uISIsCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgZ2V0UGFyYW1zWyJhdHRyXzEiXSA9IGNvbm5lY3RlZE5vZGVzWzBdLnJlcGxhY2UoImF0dHJfIiwgIiIpOwogICAgICAgICAgICAgIGdldFBhcmFtc1siYXR0cl8yIl0gPSBjb25uZWN0ZWROb2Rlc1sxXS5yZXBsYWNlKCJhdHRyXyIsICIiKTsKCiAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhjb25uZWN0ZWROb2Rlcyk7CgogICAgICAgICAgICAgIGNvbnN0IGF0dHJpYnV0ZU1hcHBpbmdJbmZvcm1hdGlvbiA9IGF3YWl0IGF4aW9zLmdldCgKICAgICAgICAgICAgICAgIHByb2Nlc3MuZW52LlZVRV9BUFBfQ0xJTklDQUxVUkwgKyAiL2dldC9hdHRyaWJ1dGUtbWFwcGluZyIsCiAgICAgICAgICAgICAgICB7IHBhcmFtczogZ2V0UGFyYW1zIH0KICAgICAgICAgICAgICApOwogICAgICAgICAgICAgIC8vY29uc29sZS5sb2coYXR0cmlidXRlTWFwcGluZ0luZm9ybWF0aW9uKTsKICAgICAgICAgICAgICB2YXIgZGF0YSA9IGF0dHJpYnV0ZU1hcHBpbmdJbmZvcm1hdGlvblsiZGF0YSJdOwogICAgICAgICAgICAgIC8vY29uc29sZS5sb2coZGF0YSk7CgogICAgICAgICAgICAgIHZhciBlbGVtID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIm1vZGFsMSIpOwogICAgICAgICAgICAgIHZhciBpbnN0YW5jZSA9IE0uTW9kYWwuZ2V0SW5zdGFuY2UoZWxlbSk7CiAgICAgICAgICAgICAgdmFyIG1vZGFsSGVhZGVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImhlYWRlck1vZGFsIik7CgogICAgICAgICAgICAgIG1vZGFsSGVhZGVyLnRleHRDb250ZW50ID0KICAgICAgICAgICAgICAgICJWYXJpYWJsZSBNYXBwaW5nOiAiICsKICAgICAgICAgICAgICAgIGdldFBhcmFtc1siYXR0cl8xIl0gKwogICAgICAgICAgICAgICAgIiwgIiArCiAgICAgICAgICAgICAgICBnZXRQYXJhbXNbImF0dHJfMiJdOwogICAgICAgICAgICAgIHZhciBtb2RhbFRleHQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgidGV4dE1vZGFsIik7CiAgICAgICAgICAgICAgbW9kYWxUZXh0LmlubmVySFRNTCA9ICIiOwogICAgICAgICAgICAgIGlmIChkYXRhWyJpbmZvcm1hdGlvbiJdID09ICJub25lIikgewogICAgICAgICAgICAgICAgbW9kYWxUZXh0LmFwcGVuZENoaWxkKAogICAgICAgICAgICAgICAgICBkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZSgKICAgICAgICAgICAgICAgICAgICAiTm8gaW5mb3JtYXRpb24gYXZhaWxhYmxlIGluIENsaW5pY2FsIEJhY2tlbmQuLi4iCiAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICBtZW51LnN0eWxlLmRpc3BsYXkgPSAibm9uZSI7CiAgICAgICAgICAgICAgICBpbnN0YW5jZS5vcGVuKCk7CiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHZhciBkYXRhX2FzX2pzb24gPSBKU09OLnBhcnNlKGRhdGFbImluZm9ybWF0aW9uIl0pWzBdWyJmaWVsZHMiXTsKCiAgICAgICAgICAgICAgICB2YXIga2V5cyA9IE9iamVjdC5rZXlzKGRhdGFfYXNfanNvbik7CgogICAgICAgICAgICAgICAgdmFyIHRibCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoInRhYmxlIik7CiAgICAgICAgICAgICAgICB0Ymwuc3R5bGUud2lkdGggPSAiMTAwJSI7CiAgICAgICAgICAgICAgICB0Ymwuc2V0QXR0cmlidXRlKCJib3JkZXIiLCAiMSIpOwogICAgICAgICAgICAgICAgdmFyIHRiZHkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJ0Ym9keSIpOwogICAgICAgICAgICAgICAga2V5cy5mb3JFYWNoKGZ1bmN0aW9uICh2YWx1ZSkgewogICAgICAgICAgICAgICAgICB2YXIgcm93ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgidHIiKTsKICAgICAgICAgICAgICAgICAgdmFyIGNlbGwxID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgidGQiKTsKICAgICAgICAgICAgICAgICAgdmFyIGNlbGwyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgidGQiKTsKICAgICAgICAgICAgICAgICAgY2VsbDEuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUodmFsdWUpKTsKCiAgICAgICAgICAgICAgICAgIGNlbGwyLmFwcGVuZENoaWxkKAogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKGRhdGFfYXNfanNvblt2YWx1ZV0pCiAgICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICAgIHJvdy5hcHBlbmRDaGlsZChjZWxsMSk7CiAgICAgICAgICAgICAgICAgIHJvdy5hcHBlbmRDaGlsZChjZWxsMik7CiAgICAgICAgICAgICAgICAgIHRiZHkuYXBwZW5kQ2hpbGQocm93KTsKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgIHRibC5hcHBlbmRDaGlsZCh0YmR5KTsKCiAgICAgICAgICAgICAgICBtb2RhbFRleHQuYXBwZW5kQ2hpbGQodGJsKTsKICAgICAgICAgICAgICAgIG1lbnUuc3R5bGUuZGlzcGxheSA9ICJub25lIjsKICAgICAgICAgICAgICAgIGluc3RhbmNlLm9wZW4oKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH07CiAgICAgICAgICAgIGJ0bi5hcHBlbmRDaGlsZCh0ZXh0Tm9kZSk7CiAgICAgICAgICAgIGxpc3RlbGVtTm9kZS5hcHBlbmRDaGlsZChidG4pOwogICAgICAgICAgICBtZW51LmZpcnN0Q2hpbGQuYXBwZW5kQ2hpbGQobGlzdGVsZW1Ob2RlKTsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIG9uQ29udGV4dENsaWNrOiBmdW5jdGlvbiAocGFyYW1zKSB7CiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJyaWdodE1lbnVMaXN0IikuaW5uZXJIVE1MID0gIiI7CiAgICAgIHZhciBwYWdleTsKICAgICAgdmFyIHBhZ2V4OwoKICAgICAgaWYgKHBhcmFtcy5ub2Rlcy5sZW5ndGggPT0gMSkgewogICAgICAgIGNvbnN0IGUgPSBwYXJhbXMuZXZlbnQ7CiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwoKICAgICAgICBjb25zdCBtZW51ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInJpZ2h0Q2xpY2tNZW51Iik7CiAgICAgICAgcGFnZXggPSBlLnBhZ2VYOwogICAgICAgIHBhZ2V5ID0gZS5wYWdlWTsKICAgICAgICBtZW51LnN0eWxlLmxlZnQgPSBgJHtwYWdleH1weGA7CiAgICAgICAgbWVudS5zdHlsZS50b3AgPSBgJHtwYWdleX1weGA7CiAgICAgICAgbWVudS5zdHlsZS5kaXNwbGF5ID0gImJsb2NrIjsKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgicmlnaHRNZW51TGlzdCIpLmlubmVySFRNTCA9ICIiOwogICAgICAgIGNvbnN0IG5ldHcgPSB0aGlzLiRyZWZzLm5ldHdvcms7CgogICAgICAgIGlmICh0aGlzLiRyZWZzLm5ldHdvcmsuaXNDbHVzdGVyKHBhcmFtcy5ub2Rlc1swXSkpIHsKICAgICAgICAgIHZhciBsaXN0ZWxlbSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImxpIik7CiAgICAgICAgICBsaXN0ZWxlbS5jbGFzc0xpc3QuYWRkKCJtZW51LW9wdGlvbiIpOwogICAgICAgICAgdmFyIHRleHQgPSBkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZSgiT3BlbiB0aGlzIENsdXN0ZXIiKTsKICAgICAgICAgIHZhciBidG4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJidXR0b24iKTsKICAgICAgICAgIGJ0bi5jbGFzc0xpc3QuYWRkKCJidG4iKTsKICAgICAgICAgIGJ0bi5jbGFzc0xpc3QuYWRkKCJ3YXZlcy1lZmZlY3QiKTsKICAgICAgICAgIGJ0bi5jbGFzc0xpc3QuYWRkKCJibHVlLWdyZXkiLCAibGlnaHRlbi0xIik7CiAgICAgICAgICBidG4uc3R5bGUuaGVpZ2h0ID0gImF1dG8iOwogICAgICAgICAgYnRuLnN0eWxlLndpZHRoID0gImF1dG8iOwogICAgICAgICAgYnRuLnN0eWxlLm1hcmdpbiA9ICIycHgiOwogICAgICAgICAgYnRuLm9uY2xpY2sgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIG5ldHcub3BlbkNsdXN0ZXIocGFyYW1zLm5vZGVzWzBdKTsKICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInJpZ2h0Q2xpY2tNZW51Iikuc3R5bGUuZGlzcGxheSA9ICJub25lIjsKICAgICAgICAgIH07CiAgICAgICAgICBidG4uYXBwZW5kQ2hpbGQodGV4dCk7CiAgICAgICAgICBsaXN0ZWxlbS5hcHBlbmRDaGlsZChidG4pOwoKICAgICAgICAgIG1lbnUuZmlyc3RDaGlsZC5hcHBlbmRDaGlsZChsaXN0ZWxlbSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIFsiSW5zcGVjdCIsICJPcGVuIHN1YiBncmFwaCIsICJTaG93IG1vcmUgaW4gT0xTIl0uZm9yRWFjaCgocykgPT4gewogICAgICAgICAgICB2YXIgbGlzdGVsZW1Ob2RlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgibGkiKTsKICAgICAgICAgICAgbGlzdGVsZW1Ob2RlLmNsYXNzTGlzdC5hZGQoIm1lbnUtb3B0aW9uIik7CiAgICAgICAgICAgIHZhciBidG4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJidXR0b24iKTsKICAgICAgICAgICAgYnRuLmNsYXNzTGlzdC5hZGQoImJ0biIpOwogICAgICAgICAgICBidG4uY2xhc3NMaXN0LmFkZCgid2F2ZXMtZWZmZWN0Iik7CiAgICAgICAgICAgIGJ0bi5jbGFzc0xpc3QuYWRkKCJibHVlLWdyZXkiLCAibGlnaHRlbi0xIik7CiAgICAgICAgICAgIGJ0bi5zdHlsZS5oZWlnaHQgPSAiYXV0byI7CiAgICAgICAgICAgIGJ0bi5zdHlsZS53aWR0aCA9ICJhdXRvIjsKICAgICAgICAgICAgYnRuLnN0eWxlLm1hcmdpbiA9ICIycHgiOwogICAgICAgICAgICB2YXIgdGV4dE5vZGUgPSBkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShzKTsKICAgICAgICAgICAgaWYgKHMgPT0gIkluc3BlY3QiKSB7CiAgICAgICAgICAgICAgYnRuLm9uY2xpY2sgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICB2YXIgZ2V0UGFyYW1zID0ge307CiAgICAgICAgICAgICAgICBpZiAocGFyYW1zLm5vZGVzWzBdLnN0YXJ0c1dpdGgoImF0dHJfIikpIHsKICAgICAgICAgICAgICAgICAgZ2V0UGFyYW1zWyJ0eXBlIl0gPSAiYXR0cmlidXRlIjsKICAgICAgICAgICAgICAgICAgZ2V0UGFyYW1zWyJub2RlIl0gPSBwYXJhbXMubm9kZXNbMF0ucmVwbGFjZSgiYXR0cl8iLCAiIik7CiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHBhcmFtcy5ub2Rlc1swXS5zdGFydHNXaXRoKCJzb3VyY2VzXyIpKSB7CiAgICAgICAgICAgICAgICAgIGdldFBhcmFtc1sidHlwZSJdID0gInNvdXJjZSI7CiAgICAgICAgICAgICAgICAgIGdldFBhcmFtc1sibm9kZSJdID0gcGFyYW1zLm5vZGVzWzBdLnJlcGxhY2UoInNvdXJjZXNfIiwgIiIpOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgZ2V0UGFyYW1zWyJ0eXBlIl0gPSAiY29yZSI7CiAgICAgICAgICAgICAgICAgIGdldFBhcmFtc1sibm9kZSJdID0gcGFyYW1zLm5vZGVzWzBdOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgY29uc3QgYXR0cmlidXRlSW5mb3JtYXRpb24gPSBheGlvcy5nZXQoCiAgICAgICAgICAgICAgICAgIHByb2Nlc3MuZW52LlZVRV9BUFBfQ0xJTklDQUxVUkwgKyAiL2dldC9hdHRyaWJ1dGUiLAogICAgICAgICAgICAgICAgICB7IHBhcmFtczogZ2V0UGFyYW1zIH0KICAgICAgICAgICAgICAgICk7CgogICAgICAgICAgICAgICAgYXR0cmlidXRlSW5mb3JtYXRpb24udGhlbigoZGF0YSkgPT4gewogICAgICAgICAgICAgICAgICB2YXIgZWxlbSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJtb2RhbDEiKTsKICAgICAgICAgICAgICAgICAgdmFyIGluc3RhbmNlID0gTS5Nb2RhbC5nZXRJbnN0YW5jZShlbGVtKTsKICAgICAgICAgICAgICAgICAgdmFyIG1vZGFsSGVhZGVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImhlYWRlck1vZGFsIik7CgogICAgICAgICAgICAgICAgICBtb2RhbEhlYWRlci50ZXh0Q29udGVudCA9CiAgICAgICAgICAgICAgICAgICAgIlZhcmlhYmxlIE5hbWU6ICIgKyBnZXRQYXJhbXNbIm5vZGUiXTsKICAgICAgICAgICAgICAgICAgdmFyIG1vZGFsVGV4dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJ0ZXh0TW9kYWwiKTsKICAgICAgICAgICAgICAgICAgbW9kYWxUZXh0LmlubmVySFRNTCA9ICIiOwoKICAgICAgICAgICAgICAgICAgaWYgKGRhdGFbImRhdGEiXVsiaW5mb3JtYXRpb24iXSA9PSAibm9uZSIpIHsKICAgICAgICAgICAgICAgICAgICBtb2RhbFRleHQuYXBwZW5kQ2hpbGQoCiAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZSgKICAgICAgICAgICAgICAgICAgICAgICAgIk5vIGluZm9ybWF0aW9uIGF2YWlsYWJsZSBpbiBDbGluaWNhbCBCYWNrZW5kLi4uIgogICAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICAgICAgbWVudS5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiOwogICAgICAgICAgICAgICAgICAgIGluc3RhbmNlLm9wZW4oKTsKICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICB2YXIgZGF0YV9hc19qc29uID0gSlNPTi5wYXJzZSgKICAgICAgICAgICAgICAgICAgICAgIGRhdGFbImRhdGEiXVsiaW5mb3JtYXRpb24iXQogICAgICAgICAgICAgICAgICAgIClbMF1bImZpZWxkcyJdOwoKICAgICAgICAgICAgICAgICAgICB2YXIga2V5cyA9IE9iamVjdC5rZXlzKGRhdGFfYXNfanNvbik7CgogICAgICAgICAgICAgICAgICAgIHZhciB0YmwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJ0YWJsZSIpOwogICAgICAgICAgICAgICAgICAgIHRibC5zdHlsZS53aWR0aCA9ICIxMDAlIjsKICAgICAgICAgICAgICAgICAgICB0Ymwuc2V0QXR0cmlidXRlKCJib3JkZXIiLCAiMSIpOwogICAgICAgICAgICAgICAgICAgIHZhciB0YmR5ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgidGJvZHkiKTsKICAgICAgICAgICAgICAgICAgICBrZXlzLmZvckVhY2goZnVuY3Rpb24gKHZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgICB2YXIgcm93ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgidHIiKTsKICAgICAgICAgICAgICAgICAgICAgIHZhciBjZWxsMSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoInRkIik7CiAgICAgICAgICAgICAgICAgICAgICB2YXIgY2VsbDIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJ0ZCIpOwogICAgICAgICAgICAgICAgICAgICAgY2VsbDEuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUodmFsdWUpKTsKCiAgICAgICAgICAgICAgICAgICAgICBjZWxsMi5hcHBlbmRDaGlsZCgKICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoZGF0YV9hc19qc29uW3ZhbHVlXSkKICAgICAgICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICAgICAgICByb3cuYXBwZW5kQ2hpbGQoY2VsbDEpOwogICAgICAgICAgICAgICAgICAgICAgcm93LmFwcGVuZENoaWxkKGNlbGwyKTsKICAgICAgICAgICAgICAgICAgICAgIHRiZHkuYXBwZW5kQ2hpbGQocm93KTsKICAgICAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICAgICAgdGJsLmFwcGVuZENoaWxkKHRiZHkpOwoKICAgICAgICAgICAgICAgICAgICBtb2RhbFRleHQuYXBwZW5kQ2hpbGQodGJsKTsKICAgICAgICAgICAgICAgICAgICBtZW51LnN0eWxlLmRpc3BsYXkgPSAibm9uZSI7CiAgICAgICAgICAgICAgICAgICAgaW5zdGFuY2Uub3BlbigpOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coYXR0cmlidXRlSW5mb3JtYXRpb24pOwogICAgICAgICAgICAgIH07CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKHMgPT0gIlNob3cgbW9yZSBpbiBPTFMiKSB7CiAgICAgICAgICAgICAgYnRuLm9uY2xpY2sgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICB3aW5kb3cub3BlbigKICAgICAgICAgICAgICAgICAgcHJvY2Vzcy5lbnYuVlVFX0FQUF9PTFNVUkwgKwogICAgICAgICAgICAgICAgICAgICJzZWFyY2g/cT0iICsKICAgICAgICAgICAgICAgICAgICBwYXJhbXMubm9kZXNbMF0ucmVwbGFjZSgiYXR0cl8iLCAiIiksCiAgICAgICAgICAgICAgICAgICJwb3BVcFdpbmRvdyIsCiAgICAgICAgICAgICAgICAgICJoZWlnaHQ9ODAwLHdpZHRoPTEyMDAsbGVmdD0xMCx0b3A9MTAsLHNjcm9sbGJhcnM9eWVzLG1lbnViYXI9bm8iCiAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICAgIH07CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKHMgPT0gIk9wZW4gc3ViIGdyYXBoIikgewogICAgICAgICAgICAgIC8vY29uc3Qgc3VibmV0dyA9IHRoaXMuJHJlZnMuc3ViX25ldHdvcms7CiAgICAgICAgICAgICAgdGhpcy5zdWJfbm9kZXMgPSBbXTsKICAgICAgICAgICAgICB0aGlzLnN1Yl9lZGdlcyA9IFtdOwogICAgICAgICAgICAgIHZhciBzdWJfbiA9IHRoaXMuc3ViX25vZGVzOwogICAgICAgICAgICAgIHZhciBzdWJfZSA9IHRoaXMuc3ViX2VkZ2VzOwogICAgICAgICAgICAgIGJ0bi5vbmNsaWNrID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgdmFyIG5vZGUgPSBwYXJhbXMubm9kZXNbMF07CiAgICAgICAgICAgICAgICB2YXIgY29ubmVjdGVkTm9kZXMgPSBuZXR3LmdldENvbm5lY3RlZE5vZGVzKG5vZGUpOwogICAgICAgICAgICAgICAgY29ubmVjdGVkTm9kZXMucHVzaChub2RlKTsKICAgICAgICAgICAgICAgIHZhciBjb25uZWN0ZWRFZGdlcyA9IG5ldHcuZ2V0Q29ubmVjdGVkRWRnZXMobm9kZSk7CgogICAgICAgICAgICAgICAgdmFyIGluc3RhbmNlMiA9IE0uTW9kYWwuZ2V0SW5zdGFuY2UoCiAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJtb2RhbDIiKQogICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgIGluc3RhbmNlMi5vcGVuKCk7CgogICAgICAgICAgICAgICAgY29ubmVjdGVkTm9kZXMuZm9yRWFjaCgobm9kZSkgPT4gewogICAgICAgICAgICAgICAgICB2YXIgbiA9IG5ldHcuZ2V0Tm9kZShub2RlKTsKICAgICAgICAgICAgICAgICAgaWYgKG4gIT0gbnVsbCkgewogICAgICAgICAgICAgICAgICAgIHN1Yl9uLnB1c2gobik7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgY29ubmVjdGVkRWRnZXMuZm9yRWFjaCgoZWRnZSkgPT4gewogICAgICAgICAgICAgICAgICB2YXIgZWQgPSBuZXR3LmdldEVkZ2UoZWRnZSk7CiAgICAgICAgICAgICAgICAgIGlmIChlZCAhPSBudWxsKSB7CiAgICAgICAgICAgICAgICAgICAgc3ViX2UucHVzaChlZCk7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgIG1lbnUuc3R5bGUuZGlzcGxheSA9ICJub25lIjsKICAgICAgICAgICAgICB9OwogICAgICAgICAgICB9CgogICAgICAgICAgICBidG4uYXBwZW5kQ2hpbGQodGV4dE5vZGUpOwogICAgICAgICAgICBsaXN0ZWxlbU5vZGUuYXBwZW5kQ2hpbGQoYnRuKTsKICAgICAgICAgICAgbWVudS5maXJzdENoaWxkLmFwcGVuZENoaWxkKGxpc3RlbGVtTm9kZSk7CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgaWYgKHBhcmFtcy5lZGdlcy5sZW5ndGggPT0gMSkgewogICAgICAgICAgdmFyIGVkZ2UgPSBwYXJhbXMuZWRnZXNbMF07CiAgICAgICAgICBjb25zdCBlID0gcGFyYW1zLmV2ZW50OwogICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwoKICAgICAgICAgIGNvbnN0IG1lbnUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgicmlnaHRDbGlja01lbnUiKTsKICAgICAgICAgIHBhZ2V4ID0gZS5wYWdlWDsKICAgICAgICAgIHBhZ2V5ID0gZS5wYWdlWTsKICAgICAgICAgIG1lbnUuc3R5bGUubGVmdCA9IGAke3BhZ2V4fXB4YDsKICAgICAgICAgIG1lbnUuc3R5bGUudG9wID0gYCR7cGFnZXl9cHhgOwogICAgICAgICAgbWVudS5zdHlsZS5kaXNwbGF5ID0gImJsb2NrIjsKICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJyaWdodE1lbnVMaXN0IikuaW5uZXJIVE1MID0gIiI7CiAgICAgICAgICBjb25zdCBuZXR3ID0gdGhpcy4kcmVmcy5uZXR3b3JrOwogICAgICAgICAgdmFyIGxpc3RlbGVtTm9kZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImxpIik7CiAgICAgICAgICBsaXN0ZWxlbU5vZGUuY2xhc3NMaXN0LmFkZCgibWVudS1vcHRpb24iKTsKICAgICAgICAgIGJ0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImJ1dHRvbiIpOwogICAgICAgICAgYnRuLmNsYXNzTGlzdC5hZGQoImJ0biIpOwogICAgICAgICAgYnRuLmNsYXNzTGlzdC5hZGQoIndhdmVzLWVmZmVjdCIpOwogICAgICAgICAgYnRuLmNsYXNzTGlzdC5hZGQoImJsdWUtZ3JleSIsICJsaWdodGVuLTEiKTsKICAgICAgICAgIGJ0bi5zdHlsZS5oZWlnaHQgPSAiYXV0byI7CiAgICAgICAgICBidG4uc3R5bGUud2lkdGggPSAiYXV0byI7CiAgICAgICAgICBidG4uc3R5bGUubWFyZ2luID0gIjJweCI7CiAgICAgICAgICB2YXIgcyA9ICJJbnNwZWN0IjsKICAgICAgICAgIHZhciB0ZXh0Tm9kZSA9IGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKHMgKyAiIEVkZ2UiKTsKICAgICAgICAgIGlmIChzID09ICJJbnNwZWN0IikgewogICAgICAgICAgICBidG4ub25jbGljayA9IGFzeW5jIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICB2YXIgZ2V0UGFyYW1zID0ge307CiAgICAgICAgICAgICAgdmFyIGNvbm5lY3RlZE5vZGVzID0gbmV0dy5nZXRDb25uZWN0ZWROb2RlcyhlZGdlKTsKICAgICAgICAgICAgICBpZiAoCiAgICAgICAgICAgICAgICBjb25uZWN0ZWROb2Rlc1swXS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCJjbHVzdGVyIikgfHwKICAgICAgICAgICAgICAgIGNvbm5lY3RlZE5vZGVzWzFdLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoImNsdXN0ZXIiKQogICAgICAgICAgICAgICkgewogICAgICAgICAgICAgICAgTS50b2FzdCh7CiAgICAgICAgICAgICAgICAgIGh0bWw6ICJQbGVhc2UgT3BlbiB0aGUgY2x1c3RlciBiZWZvcmUgaW5zcGVjdGluZyBlZGdlcyEiLAogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIGlmICgKICAgICAgICAgICAgICAgIGNvbm5lY3RlZE5vZGVzWzBdLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoInNvdXJjZSIpIHx8CiAgICAgICAgICAgICAgICBjb25uZWN0ZWROb2Rlc1sxXS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCJzb3VyY2UiKQogICAgICAgICAgICAgICkgewogICAgICAgICAgICAgICAgTS50b2FzdCh7CiAgICAgICAgICAgICAgICAgIGh0bWw6CiAgICAgICAgICAgICAgICAgICAgIk1hcHBpbmdzIG9mIHR5cGUgJ3BhcnRfb2YnIGRvIG5vdCBjb250YWluIG1vcmUgaW5mb3JtYXRpb24hIiwKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBnZXRQYXJhbXNbImF0dHJfMSJdID0gY29ubmVjdGVkTm9kZXNbMF0ucmVwbGFjZSgiYXR0cl8iLCAiIik7CiAgICAgICAgICAgICAgZ2V0UGFyYW1zWyJhdHRyXzIiXSA9IGNvbm5lY3RlZE5vZGVzWzFdLnJlcGxhY2UoImF0dHJfIiwgIiIpOwoKICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKGNvbm5lY3RlZE5vZGVzKTsKCiAgICAgICAgICAgICAgY29uc3QgYXR0cmlidXRlTWFwcGluZ0luZm9ybWF0aW9uID0gYXdhaXQgYXhpb3MuZ2V0KAogICAgICAgICAgICAgICAgcHJvY2Vzcy5lbnYuVlVFX0FQUF9DTElOSUNBTFVSTCArICIvZ2V0L2F0dHJpYnV0ZS1tYXBwaW5nIiwKICAgICAgICAgICAgICAgIHsgcGFyYW1zOiBnZXRQYXJhbXMgfQogICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhhdHRyaWJ1dGVNYXBwaW5nSW5mb3JtYXRpb24pOwogICAgICAgICAgICAgIHZhciBkYXRhID0gYXR0cmlidXRlTWFwcGluZ0luZm9ybWF0aW9uWyJkYXRhIl07CiAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhkYXRhKTsKCiAgICAgICAgICAgICAgdmFyIGVsZW0gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgibW9kYWwxIik7CiAgICAgICAgICAgICAgdmFyIGluc3RhbmNlID0gTS5Nb2RhbC5nZXRJbnN0YW5jZShlbGVtKTsKICAgICAgICAgICAgICB2YXIgbW9kYWxIZWFkZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiaGVhZGVyTW9kYWwiKTsKCiAgICAgICAgICAgICAgbW9kYWxIZWFkZXIudGV4dENvbnRlbnQgPQogICAgICAgICAgICAgICAgIlZhcmlhYmxlIE1hcHBpbmc6ICIgKwogICAgICAgICAgICAgICAgZ2V0UGFyYW1zWyJhdHRyXzEiXSArCiAgICAgICAgICAgICAgICAiLCAiICsKICAgICAgICAgICAgICAgIGdldFBhcmFtc1siYXR0cl8yIl07CiAgICAgICAgICAgICAgdmFyIG1vZGFsVGV4dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJ0ZXh0TW9kYWwiKTsKICAgICAgICAgICAgICBtb2RhbFRleHQuaW5uZXJIVE1MID0gIiI7CiAgICAgICAgICAgICAgaWYgKGRhdGFbImluZm9ybWF0aW9uIl0gPT0gIm5vbmUiKSB7CiAgICAgICAgICAgICAgICBtb2RhbFRleHQuYXBwZW5kQ2hpbGQoCiAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKAogICAgICAgICAgICAgICAgICAgICJObyBpbmZvcm1hdGlvbiBhdmFpbGFibGUgaW4gQ2xpbmljYWwgQmFja2VuZC4uLiIKICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgIG1lbnUuc3R5bGUuZGlzcGxheSA9ICJub25lIjsKICAgICAgICAgICAgICAgIGluc3RhbmNlLm9wZW4oKTsKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgdmFyIGRhdGFfYXNfanNvbiA9IEpTT04ucGFyc2UoZGF0YVsiaW5mb3JtYXRpb24iXSlbMF1bImZpZWxkcyJdOwoKICAgICAgICAgICAgICAgIHZhciBrZXlzID0gT2JqZWN0LmtleXMoZGF0YV9hc19qc29uKTsKCiAgICAgICAgICAgICAgICB2YXIgdGJsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgidGFibGUiKTsKICAgICAgICAgICAgICAgIHRibC5zdHlsZS53aWR0aCA9ICIxMDAlIjsKICAgICAgICAgICAgICAgIHRibC5zZXRBdHRyaWJ1dGUoImJvcmRlciIsICIxIik7CiAgICAgICAgICAgICAgICB2YXIgdGJkeSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoInRib2R5Iik7CiAgICAgICAgICAgICAgICBrZXlzLmZvckVhY2goZnVuY3Rpb24gKHZhbHVlKSB7CiAgICAgICAgICAgICAgICAgIHZhciByb3cgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJ0ciIpOwogICAgICAgICAgICAgICAgICB2YXIgY2VsbDEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJ0ZCIpOwogICAgICAgICAgICAgICAgICB2YXIgY2VsbDIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJ0ZCIpOwogICAgICAgICAgICAgICAgICBjZWxsMS5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZSh2YWx1ZSkpOwoKICAgICAgICAgICAgICAgICAgY2VsbDIuYXBwZW5kQ2hpbGQoCiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoZGF0YV9hc19qc29uW3ZhbHVlXSkKICAgICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgICAgcm93LmFwcGVuZENoaWxkKGNlbGwxKTsKICAgICAgICAgICAgICAgICAgcm93LmFwcGVuZENoaWxkKGNlbGwyKTsKICAgICAgICAgICAgICAgICAgdGJkeS5hcHBlbmRDaGlsZChyb3cpOwogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgdGJsLmFwcGVuZENoaWxkKHRiZHkpOwoKICAgICAgICAgICAgICAgIG1vZGFsVGV4dC5hcHBlbmRDaGlsZCh0YmwpOwogICAgICAgICAgICAgICAgbWVudS5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiOwogICAgICAgICAgICAgICAgaW5zdGFuY2Uub3BlbigpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfTsKICAgICAgICAgICAgYnRuLmFwcGVuZENoaWxkKHRleHROb2RlKTsKICAgICAgICAgICAgbGlzdGVsZW1Ob2RlLmFwcGVuZENoaWxkKGJ0bik7CiAgICAgICAgICAgIG1lbnUuZmlyc3RDaGlsZC5hcHBlbmRDaGlsZChsaXN0ZWxlbU5vZGUpOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgY2x1c3Rlck9wZW5BbGw6IGZ1bmN0aW9uICgpIHsKICAgICAgZm9yICh2YXIgbm9kZSBpbiB0aGlzLm5vZGVzKSB7CiAgICAgICAgaWYgKHRoaXMuJHJlZnMubmV0d29yay5pc0NsdXN0ZXIobm9kZSkgPT0gdHJ1ZSkgewogICAgICAgICAgdGhpcy4kcmVmcy5uZXR3b3JrLm9wZW5DbHVzdGVyKG5vZGUpOwogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIG9uTm9kZUNsaWNrOiBmdW5jdGlvbiAocGFyYW1zKSB7CiAgICAgIGNvbnNvbGUubG9nKCJDbGlja2VkIGRvdWJsZSIpOwogICAgICAvL2NvbnNvbGUubG9nKCJIQUxMT0hBTExPIik7CiAgICAgIGlmIChwYXJhbXMubm9kZXMubGVuZ3RoID09IDEpIHsKICAgICAgICBpZiAodGhpcy4kcmVmcy5uZXR3b3JrLmlzQ2x1c3RlcihwYXJhbXMubm9kZXNbMF0pID09IHRydWUpIHsKICAgICAgICAgIHRoaXMuJHJlZnMubmV0d29yay5vcGVuQ2x1c3RlcihwYXJhbXMubm9kZXNbMF0pOwogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIGRpc2FibGVQaHlzaWNzOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBvcHRzID0gdGhpcy4kcmVmcy5uZXR3b3JrWyJvcHRpb25zIl07CiAgICAgIG9wdHNbInBoeXNpY3MiXVsiZW5hYmxlZCJdID0gZmFsc2U7CiAgICAgIHRoaXMuJHJlZnMubmV0d29yay5zZXRPcHRpb25zKG9wdHMpOwogICAgfSwKICAgIGVuYWJsZVBoeXNpY3M6IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIG9wdHMgPSB0aGlzLiRyZWZzLm5ldHdvcmtbIm9wdGlvbnMiXTsKICAgICAgb3B0c1sicGh5c2ljcyJdWyJlbmFibGVkIl0gPSB0cnVlOwogICAgICB0aGlzLiRyZWZzLm5ldHdvcmsuc2V0T3B0aW9ucyhvcHRzKTsKICAgIH0sCiAgICBidG5DbGljazogZnVuY3Rpb24gKCkgewogICAgICB2YXIgb3B0aW9uc190b3BpYyA9IHsKICAgICAgICBqb2luQ29uZGl0aW9uOiBmdW5jdGlvbiAobm9kZU9wdGlvbnMpIHsKICAgICAgICAgIC8vY29uc29sZS5sb2coIkhBTExPSEFMTE8iKTsKICAgICAgICAgIHJldHVybiBub2RlT3B0aW9ucy5jaWQgPT0gdGhpcy50b3BpY3NfYWxsWzFdOwogICAgICAgIH0sCiAgICAgICAgY2x1c3Rlck5vZGVQcm9wZXJ0aWVzOiB7CiAgICAgICAgICBpZDogImNpZENsdXN0ZXJfIiArIHRoaXMudG9waWNzX2FsbFsxXSwKICAgICAgICAgIGJvcmRlcldpZHRoOiAzLAogICAgICAgICAgc2hhcGU6ICJjaXJjbGUiLAogICAgICAgICAgbGFiZWw6IHRoaXMudG9waWNzX2FsbFsxXSwKICAgICAgICB9LAogICAgICB9OwogICAgICBjb25zb2xlLmxvZygiY2x1c3RlcmluZy4uLiIpOwogICAgICB0aGlzLiRyZWZzLm5ldHdvcmsuY2x1c3RlcihvcHRpb25zX3RvcGljKTsKICAgIH0sCiAgICBmdWxsdGV4dFNlYXJjaDogZnVuY3Rpb24gKCkgewogICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiZnVsbHRleHRfcmVzdWx0IikuaW5uZXJIVE1MID0gIiI7CiAgICAgIHZhciBuZXR3b3JrID0gdGhpcy4kcmVmcy5uZXR3b3JrOwogICAgICB2YXIgbm9kZXMgPSB0aGlzLm5vZGVzOwogICAgICBmdW5jdGlvbiBzZWxlY3RUaGlzTm9kZShub2RlSWQpIHsKICAgICAgICB2YXIgZmluZE5vZGVzUmV0dXJuID0gbmV0d29yay5maW5kTm9kZShub2RlSWQpOwogICAgICAgIGlmIChuZXR3b3JrLmlzQ2x1c3RlcihmaW5kTm9kZXNSZXR1cm5bMF0pKSB7CiAgICAgICAgICBuZXR3b3JrLm9wZW5DbHVzdGVyKGZpbmROb2Rlc1JldHVyblswXSk7CiAgICAgICAgICByZXR1cm4gc2VsZWN0VGhpc05vZGUobm9kZUlkKTsKICAgICAgICB9CiAgICAgICAgLy9jb25zb2xlLmxvZyhub2RlSWQpOwogICAgICAgIG5ldHdvcmsuZm9jdXMobm9kZUlkKTsKICAgICAgICBuZXR3b3JrLnNlbGVjdE5vZGVzKFtub2RlSWRdLCBbdHJ1ZV0pOwogICAgICAgIC8vIGNvbnNvbGUubG9nKG5vZGVzKTsKICAgICAgICB2YXIgc2VsID0gbm9kZXMuZmluZCgob2JqKSA9PiB7CiAgICAgICAgICByZXR1cm4gb2JqWyJpZCJdID09IG5vZGVJZDsKICAgICAgICB9KTsKICAgICAgIAogICAgICAgIHNlbFsiY29sb3IiXSA9IHsKICAgICAgICAgIGJhY2tncm91bmQ6ICJyZWQiLAogICAgICAgIH07CiAgICAgICAgCiAgICAgICAgbmV0d29yay5lZGl0Tm9kZSgpOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdmFyIGZ1bGx0ZXh0X21vZGFsID0gTS5Nb2RhbC5nZXRJbnN0YW5jZSgKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgibW9kYWxfZnVsbHRleHQiKQogICAgICApOwogICAgICBmdWxsdGV4dF9tb2RhbC5vcGVuKCk7CiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJmdWxsdGV4dF9pbnB1dCIpLnZhbHVlID0gIiI7CiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJmdWxsdGV4dF9pbnB1dCIpLmZvY3VzKCk7CiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJmdWxsdGV4dF9mb3JtIikub25zdWJtaXQgPSBhc3luYyBmdW5jdGlvbiAoZSkgewogICAgICAgIGUucHJldmVudERlZmF1bHQoKTsKCiAgICAgICAgY29uc3QgZnVsbHRleHRSZXN1bHQgPSBhd2FpdCBheGlvcyh7CiAgICAgICAgICB1cmw6CiAgICAgICAgICAgIHByb2Nlc3MuZW52LlZVRV9BUFBfQ0xJTklDQUxVUkwgKwogICAgICAgICAgICAiL2dldC9mdWxsdGV4dCIgKwogICAgICAgICAgICAiP3RleHQ9IiArCiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJmdWxsdGV4dF9pbnB1dCIpLnZhbHVlLAogICAgICAgIH0pOwogICAgICAgIGlmICgKICAgICAgICAgIGZ1bGx0ZXh0UmVzdWx0LnN0YXR1cyA9PSAyMDAgJiYKICAgICAgICAgIGZ1bGx0ZXh0UmVzdWx0WyJkYXRhIl1bInJlc3VsdCJdLmxlbmd0aCA+IDAKICAgICAgICApIHsKICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJmdWxsdGV4dF9yZXN1bHQiKS5pbm5lckhUTUwgPSAiIjsKICAgICAgICAgIGRvY3VtZW50CiAgICAgICAgICAgIC5nZXRFbGVtZW50QnlJZCgiZnVsbHRleHRfcmVzdWx0IikKICAgICAgICAgICAgLmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKCJTZWFyY2ggUmVzdWx0czogIikpOwogICAgICAgICAgZnVsbHRleHRSZXN1bHRbImRhdGEiXVsicmVzdWx0Il0uZm9yRWFjaCgocmVzdWx0KSA9PiB7CiAgICAgICAgICAgIHZhciBidG4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJidXR0b24iKTsKICAgICAgICAgICAgYnRuLm9uY2xpY2sgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgZnVsbHRleHRfbW9kYWwuY2xvc2UoKTsKICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKHJlc3VsdCk7CiAgICAgICAgICAgICAgc2VsZWN0VGhpc05vZGUoImF0dHJfIiArIHJlc3VsdCk7CiAgICAgICAgICAgIH07CiAgICAgICAgICAgIGJ0bi5jbGFzc0xpc3QuYWRkKCJidG4iLCAid2F2ZXMtZWZmZWN0IiwgImJsdWUtZ3JleSIsICJsaWdodGVuLTEiKTsKICAgICAgICAgICAgYnRuLmlubmVySFRNTCA9IHJlc3VsdDsKICAgICAgICAgICAgdmFyIHJvdyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpOwogICAgICAgICAgICByb3cuY2xhc3NMaXN0LmFkZCgicm93Iik7CiAgICAgICAgICAgIHJvdy5hcHBlbmRDaGlsZChidG4pOwogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiZnVsbHRleHRfcmVzdWx0IikuYXBwZW5kQ2hpbGQocm93KTsKICAgICAgICAgIH0pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiZnVsbHRleHRfcmVzdWx0IikuaW5uZXJIVE1MID0gIiI7CiAgICAgICAgICBkb2N1bWVudAogICAgICAgICAgICAuZ2V0RWxlbWVudEJ5SWQoImZ1bGx0ZXh0X3Jlc3VsdCIpCiAgICAgICAgICAgIC5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZSgiTm8gQXR0cmlidXRlL3MgRm91bmQuLi4iKSk7CiAgICAgICAgfQogICAgICB9OwogICAgfSwKICB9LAoKICBtb3VudGVkKCl7CiAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgiZm9vdGVyLWZpeGVkIilbMF0uc3R5bGUucG9zaXRpb24gPSAicmVsYXRpdmUiOwogIH0sCiAgYXN5bmMgY3JlYXRlZCgpIHsKICAgCgogICAgdmFyIGVsZW1zX3Rvb2x0aXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcudG9vbHRpcHBlZCcpOwogICAgTS5Ub29sdGlwLmluaXQoZWxlbXNfdG9vbHRpcCk7CiAgICAvL2RvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2FkZXJfdGV4dCcpLmlubmVySFRNTD0iRmV0Y2hpbmcgQXR0cmlidXRlcy4uLiI7CiAgICBjb25zdCBhdHRyaWJ1dGVzID0gYXdhaXQgYXhpb3MuZ2V0KAogICAgICBwcm9jZXNzLmVudi5WVUVfQVBQX0NMSU5JQ0FMVVJMICsgIi9nZXQvYXR0cmlidXRlcy9hbGwiCiAgICApOwogICAgLy9kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9hZGVyX3RleHQnKS5pbm5lckhUTUw9IkZldGNoaW5nIFNvdXJjZXMuLi4iOwogICAgY29uc3Qgc291cmNlc19hbGwgPSBhd2FpdCBheGlvcy5nZXQoCiAgICAgIHByb2Nlc3MuZW52LlZVRV9BUFBfQ0xJTklDQUxVUkwgKyAiL2dldC9zb3VyY2VzL2FsbCIKICAgICk7CiAgICAvL2RvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2FkZXJfdGV4dCcpLmlubmVySFRNTD0iRmV0Y2hpbmcgTWFwcGluZ3MuLi4iOwogICAgY29uc3QgYXR0cl9tYXBwaW5ncyA9IGF3YWl0IGF4aW9zLmdldCgKICAgICAgcHJvY2Vzcy5lbnYuVlVFX0FQUF9DTElOSUNBTFVSTCArICIvZ2V0L2F0dHJpYnV0ZS1tYXBwaW5ncy9hbGwiCiAgICApOwoKICAgIHZhciBlbGVtc01vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgiLm1vZGFsIik7CiAgICBNLk1vZGFsLmluaXQoZWxlbXNNb2RhbCk7CgoKICAgIGZvcihjb25zdCB0IGluIHRoaXMudG9waWNzX2RpY3QpewogICAgICBpZiAoIXRoaXMubm9kZXMuZmlsdGVyKGUgPT4gZS5pZCA9PSB0aGlzLnRvcGljc19kaWN0W3RdKS5sZW5ndGggPiAwKSB7CiAgCiAgICAgICAgY29uc29sZS5sb2coIkFEREVEOiIgKyB0KTsKICAgICAgCiAgICAgIHRoaXMubm9kZXMucHVzaCgKICAgICAgewogICAgICAgICAgaWQ6IHRoaXMudG9waWNzX2RpY3RbdF0sCiAgICAgICAgICBsYWJlbDogdGhpcy50b3BpY3NfZGljdFt0XSwKICAgICAgICAgIGNvbG9yOiB7CiAgICAgICAgICAgICBiYWNrZ3JvdW5kOiAiI2M1NWUyZCIsCiAgICAgICAgICAgICBib3JkZXI6ICIjYzU1ZTJkIgogICAgICAgICAgfSwKICAgICAgICAgIGZpeGVkOiB0cnVlLAoKICAgICAgICAgIGZvbnQ6IHsgY29sb3I6ICJ3aGl0ZSIgfSwKICAgICAgICB9CiAgICApOwogICAgdGhpcy5lZGdlcy5wdXNoKHsgZnJvbTogdGhpcy50b3BpY3NfZGljdFt0XSwgdG86ICJyb290IiwgY29sb3I6ICJibGFjayIgfSk7CiAgICAgIH0KICB9CgoKICAgIHZhciB0b3BpY3MgPSBuZXcgU2V0KCk7CiAgICAvL2NvbnNvbGUubG9nKHJlc3BvbnNlKTsKICAgIHZhciBhdHRyID0gYXR0cmlidXRlc1siZGF0YSJdWyJhdHRyaWJ1dGVzIl07CiAgICAvL2RvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2FkZXJfdGV4dCcpLmlubmVySFRNTD0iQnVpbGRpbmcgZ3JhcGguLi4iOwogICAgZm9yICh2YXIgayA9IDA7IGsgPCBhdHRyLmxlbmd0aDsgaysrKSB7CiAgICAgIC8vY29uc29sZS5sb2coYXR0cltrXVsidG9waWMiXSk7CiAgICAgIHRvcGljcy5hZGQoYXR0cltrXVsidG9waWMiXSk7CgogICAgICB0aGlzLm5vZGVzLnB1c2goewogICAgICAgIGlkOiAiYXR0cl8iICsgYXR0cltrXVsibmFtZSJdLAogICAgICAgIGxhYmVsOiBhdHRyW2tdWyJ0b29sdGlwIl0sCiAgICAgICAgY2lkOiBhdHRyW2tdWyJ0b3BpYyJdLAogICAgICAgIGNvbG9yOiB7CiAgICAgICAgICBiYWNrZ3JvdW5kOiAiIzFkNmU4OCIsCiAgICAgICAgICBib3JkZXI6ICIjMWQ2ZTg4IgogICAgICAgIH0sCiAgICAgICAgZm9udDogewogICAgICAgICAgY29sb3I6ICJ3aGl0ZSIKICAgICAgICB9CiAgICAgIH0pOwogICAgICBmb3IoY29uc3QgdCBpbiB0aGlzLnRvcGljc19kaWN0KXsKICAgICAgICBpZih0ID09IGF0dHJba11bInRvcGljIl0pewogICAgICAgICAgdGhpcy5lZGdlcy5wdXNoKHsKICAgICAgICAgICAgZnJvbTogImF0dHJfIiArIGF0dHJba11bIm5hbWUiXSwKICAgICAgICAgICAgdG86IHRoaXMudG9waWNzX2RpY3RbdF0sCgogICAgICAgICAgICBjb2xvcjogImJsYWNrIiwKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfQogICAgICAvLyBzd2l0Y2ggKGF0dHJba11bInRvcGljIl0pIHsKICAgICAgLy8gICBjYXNlICJEaXN0dXJiYW5jZXMiOgogICAgICAvLyAgICAgdGhpcy5lZGdlcy5wdXNoKHsKICAgICAgLy8gICAgICAgZnJvbTogImF0dHJfIiArIGF0dHJba11bIm5hbWUiXSwKICAgICAgLy8gICAgICAgdG86ICJxdWFsaWZuZXVyb3Rlc3QiLAoKICAgICAgLy8gICAgICAgY29sb3I6ICJibHVlIiwKICAgICAgLy8gICAgIH0pOwogICAgICAvLyAgICAgYnJlYWs7CiAgICAgIC8vICAgY2FzZSAibWFzdGVyIjoKICAgICAgLy8gICAgIHRoaXMuZWRnZXMucHVzaCh7CiAgICAgIC8vICAgICAgIGZyb206ICJhdHRyXyIgKyBhdHRyW2tdWyJuYW1lIl0sCiAgICAgIC8vICAgICAgIHRvOiAic2luZ3VsYXIiLAogICAgICAvLyAgICAgICBsYWJlbDogInBhcnQgb2YiLAoKICAgICAgLy8gICAgICAgY29sb3I6ICJibHVlIiwKICAgICAgLy8gICAgIH0pOwogICAgICAvLyAgICAgYnJlYWs7CiAgICAgIC8vICAgY2FzZSAiTlBUIjoKICAgICAgLy8gICAgIHRoaXMuZWRnZXMucHVzaCh7CiAgICAgIC8vICAgICAgIGZyb206ICJhdHRyXyIgKyBhdHRyW2tdWyJuYW1lIl0sCiAgICAgIC8vICAgICAgIHRvOiAibmV1cm90ZXN0IiwKCiAgICAgIC8vICAgICAgIGNvbG9yOiAiYmx1ZSIsCiAgICAgIC8vICAgICB9KTsKICAgICAgLy8gICAgIGJyZWFrOwogICAgICAvLyAgIGNhc2UgIkJsb29kIjoKICAgICAgLy8gICAgIHRoaXMuZWRnZXMucHVzaCh7CiAgICAgIC8vICAgICAgIGZyb206ICJhdHRyXyIgKyBhdHRyW2tdWyJuYW1lIl0sCiAgICAgIC8vICAgICAgIHRvOiAiYmxvb2QiLAoKICAgICAgLy8gICAgICAgY29sb3I6ICJibHVlIiwKICAgICAgLy8gICAgIH0pOwogICAgICAvLyAgICAgYnJlYWs7CiAgICAgIC8vICAgY2FzZSAiQ1NGIjoKICAgICAgLy8gICAgIHRoaXMuZWRnZXMucHVzaCh7CiAgICAgIC8vICAgICAgIGZyb206ICJhdHRyXyIgKyBhdHRyW2tdWyJuYW1lIl0sCiAgICAgIC8vICAgICAgIHRvOiAic3BpbmVmbHVpZCIsCgogICAgICAvLyAgICAgICBjb2xvcjogImJsdWUiLAogICAgICAvLyAgICAgfSk7CiAgICAgIC8vICAgICBicmVhazsKICAgICAgLy8gICBjYXNlICJBdGF4aWEiOgogICAgICAvLyAgICAgdGhpcy5lZGdlcy5wdXNoKHsKICAgICAgLy8gICAgICAgZnJvbTogImF0dHJfIiArIGF0dHJba11bIm5hbWUiXSwKICAgICAgLy8gICAgICAgdG86ICJhdGF4aWEiLAogICAgICAvLyAgICAgICBjb2xvcjogImJsdWUiLAogICAgICAvLyAgICAgfSk7CiAgICAgIC8vICAgICBicmVhazsKICAgICAgLy8gICBjYXNlICJTQVJBIHNjb3JlcyI6CiAgICAgIC8vICAgICB0aGlzLmVkZ2VzLnB1c2goewogICAgICAvLyAgICAgICBmcm9tOiAiYXR0cl8iICsgYXR0cltrXVsibmFtZSJdLAogICAgICAvLyAgICAgICB0bzogInNhcmFfc2NvcmVzIiwKICAgICAgLy8gICAgICAgY29sb3I6ICJibHVlIiwKICAgICAgLy8gICAgIH0pOwogICAgICAvLyAgICAgYnJlYWs7CiAgICAgIC8vICAgY2FzZSAiU0FSQSBzdWJzY29yZXMiOgogICAgICAvLyAgICAgdGhpcy5lZGdlcy5wdXNoKHsKICAgICAgLy8gICAgICAgZnJvbTogImF0dHJfIiArIGF0dHJba11bIm5hbWUiXSwKICAgICAgLy8gICAgICAgdG86ICJzYXJhX3N1YnNjb3JlcyIsCiAgICAgIC8vICAgICAgIGNvbG9yOiAiYmx1ZSIsCiAgICAgIC8vICAgICB9KTsKICAgICAgLy8gICAgIGJyZWFrOwogICAgICAvLyAgIGNhc2UgIlNBUkEiOgogICAgICAvLyAgICAgdGhpcy5lZGdlcy5wdXNoKHsKICAgICAgLy8gICAgICAgZnJvbTogImF0dHJfIiArIGF0dHJba11bIm5hbWUiXSwKICAgICAgLy8gICAgICAgdG86ICJzYXJhIiwKICAgICAgLy8gICAgICAgY29sb3I6ICJibHVlIiwKICAgICAgLy8gICAgIH0pOwogICAgICAvLyAgICAgYnJlYWs7CgogICAgICAvLyAgIGRlZmF1bHQ6CiAgICAgIC8vICAgICBjb25zb2xlLmxvZygiTm8gdG9waWMgZm91bmQuLi4iKTsKICAgICAgLy99CiAgICB9CgogICAgdmFyIHNvdXJjZXMgPSBzb3VyY2VzX2FsbFsiZGF0YSJdWyJzb3VyY2VzIl07CiAgICAvL2NvbnNvbGUubG9nKHJlc3BvbnNlKTsKICAgIGZvciAodmFyIHMgPSAwOyBzIDwgc291cmNlcy5sZW5ndGg7IHMrKykgewogICAgICB0aGlzLm5vZGVzLnB1c2goewogICAgICAgIGlkOiAic291cmNlc18iICsgc291cmNlc1tzXSwKICAgICAgICBsYWJlbDogc291cmNlc1tzXSwKICAgICAgICBjaWQ6IHNvdXJjZXNbc10sCiAgICAgICAgZml4ZWQ6IHRydWUsCiAgICAgICAgY29sb3I6IHsKICAgICAgICAgIGJhY2tncm91bmQ6ICIjYzJhZDRiIiwKICAgICAgICAgIGJvcmRlcjogIiNjMmFkNGIiCiAgICAgICAgfSwKICAgICAgICBoaWdobGlnaHQ6ICJyZWQiLAogICAgICAgIGZvbnQ6IHsgY29sb3I6ICJibGFjayIgfSwKICAgICAgfSk7CiAgICAgIC8vVE9ETyBhZGQgZWRnZXMKICAgIH0KICAgIHRoaXMuc291cmNlc19hbGwgPSBBcnJheS5mcm9tKHNvdXJjZXMpOwogICAgdGhpcy50b3BpY3NfYWxsID0gQXJyYXkuZnJvbSh0b3BpY3MpOwoKICAgIHZhciBhdHRyaWJ1dGVfbWFwcGluZ3MgPSBhdHRyX21hcHBpbmdzWyJkYXRhIl1bIm1hcHBpbmdzIl07CiAgICBmb3IgKHZhciBkID0gMDsgZCA8IGF0dHJpYnV0ZV9tYXBwaW5ncy5sZW5ndGg7IGQrKykgewogICAgICBpZiAoCiAgICAgICAgIXRoaXMubm9kZXMuc29tZSgKICAgICAgICAgIChub2RlKSA9PiBub2RlLmlkID09ICJhdHRyXyIgKyBhdHRyaWJ1dGVfbWFwcGluZ3NbZF1bIm5hbWUiXQogICAgICAgICkKICAgICAgKSB7CiAgICAgICAgdGhpcy5ub2Rlcy5wdXNoKHsKICAgICAgICAgIGlkOiAiYXR0cl8iICsgYXR0cmlidXRlX21hcHBpbmdzW2RdWyJuYW1lIl0sCiAgICAgICAgICBjaWQ6IGF0dHJpYnV0ZV9tYXBwaW5nc1tkXVsiU291cmNlIl0sCiAgICAgICAgICBsYWJlbDogYXR0cmlidXRlX21hcHBpbmdzW2RdWyJuYW1lIl0sCiAgICAgICAgICBjb2xvcjogewogICAgICAgICAgICBiYWNrZ3JvdW5kOiAiIzAwYmNiZCIsCiAgICAgICAgICAgIGJvcmRlcjogIiMwMGJjYmQiLAogICAgICAgICAgICBoaWdobGlnaHQ6IHsKICAgICAgICAgICAgICBiYWNrZ3JvdW5kOiAicmVkIiwKICAgICAgICAgICAgfSwKICAgICAgICAgIH0sCgogICAgICAgICAgZm9udDogeyBjb2xvcjogImJsYWNrIiB9LAogICAgICAgIH0pOwogICAgICB9CiAgICAgIGlmICgKICAgICAgICAvLyBjaGVjayBpZiBlZGdlIGlzIGFscmVhZHkgc2V0IGFuZCBpZiBub3Qgc2VsZi1tYXAgaXMgc2V0CiAgICAgICAgIXRoaXMuZWRnZXMuc29tZSgKICAgICAgICAgIChlZGdlKSA9PgogICAgICAgICAgICBlZGdlLmZyb20gPT0gImF0dHJfIiArIGF0dHJpYnV0ZV9tYXBwaW5nc1tkXVsibmFtZSJdICYmCiAgICAgICAgICAgIGVkZ2UudG8gPT0gImF0dHJfIiArIGF0dHJpYnV0ZV9tYXBwaW5nc1tkXVsiVGFyZ2V0Il0KICAgICAgICApICYmCiAgICAgICAgImF0dHJfIiArIGF0dHJpYnV0ZV9tYXBwaW5nc1tkXVsibmFtZSJdICE9CiAgICAgICAgICAiYXR0cl8iICsgYXR0cmlidXRlX21hcHBpbmdzW2RdWyJUYXJnZXQiXQogICAgICApIHsKICAgICAgICB0aGlzLmVkZ2VzLnB1c2goewogICAgICAgICAgZnJvbTogImF0dHJfIiArIGF0dHJpYnV0ZV9tYXBwaW5nc1tkXVsibmFtZSJdLAogICAgICAgICAgdG86ICJhdHRyXyIgKyBhdHRyaWJ1dGVfbWFwcGluZ3NbZF1bIlRhcmdldCJdLAoKICAgICAgICAgIGNvbG9yOiAiYmx1ZSIsCiAgICAgICAgfSk7CiAgICAgIH0KICAgICAgdGhpcy5lZGdlcy5wdXNoKHsKICAgICAgICB0bzogInNvdXJjZXNfIiArIGF0dHJpYnV0ZV9tYXBwaW5nc1tkXVsiU291cmNlIl0sCiAgICAgICAgZnJvbTogImF0dHJfIiArIGF0dHJpYnV0ZV9tYXBwaW5nc1tkXVsibmFtZSJdLAogICAgICAgIGNvbG9yOiAiZ3JleSIsCiAgICAgICAgZGFzaGVzOiB0cnVlCiAgICAgIH0pOwogICAgfQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImZ1bGx0ZXh0X2Zvcm0iKS5vbnN1Ym1pdCA9IGZ1bmN0aW9uIChlKSB7CiAgICAgIGUucHJldmVudERlZmF1bHQoKTsKICAgICAgYWxlcnQoIk5vdCBpbXBsZW1lbnRlZCB5ZXQuLi4iKTsKICAgIH07CiAgICAvLyBhbGlnbiBmaXhlZCBub2RlcyBvbiB1bml0IGNpcmNsZToKICAgIHZhciBfdG9waWNzID0gdGhpcy5ub2Rlcy5maWx0ZXIoKGVsZW0pID0+IHsKICAgICAgcmV0dXJuIGVsZW0uZml4ZWQgJiYgZWxlbS5pZCAhPSAicm9vdCIgJiYgIWVsZW0uaWQuc3RhcnRzV2l0aCgic291cmNlc18iKTsKICAgIH0pOwogICAgdmFyIF9zb3VyY2VzID0gdGhpcy5ub2Rlcy5maWx0ZXIoKGVsZW0pID0+IHsKICAgICAgcmV0dXJuIGVsZW0uZml4ZWQgJiYgZWxlbS5pZC5zdGFydHNXaXRoKCJzb3VyY2VzXyIpOwogICAgfSk7CiAgICBjb25zb2xlLmxvZyhfc291cmNlcyk7CgoKCgogICAgdmFyIF96ID0gX3NvdXJjZXMubGVuZ3RoOwogICAgX3NvdXJjZXMuZm9yRWFjaCgocywgbCkgPT4gewogICAgICBzLnggPSBNYXRoLnJvdW5kKE1hdGguY29zKCgyICogTWF0aC5QSSAqIGwpIC8gX3opICogNTAwKTsKICAgICAgcy55ID0gTWF0aC5yb3VuZChNYXRoLnNpbigoMiAqIE1hdGguUEkgKiBsKSAvIF96KSAqIDUwMCk7CiAgICB9KTsKICAgIC8vY29uc29sZS5sb2coX3RvcGljcyk7CiAgICB2YXIgX2sgPSBfdG9waWNzLmxlbmd0aDsKICAgIF90b3BpY3MuZm9yRWFjaCgodCwgbCkgPT4gewogICAgICB0LnggPSBNYXRoLnJvdW5kKE1hdGguY29zKCgyICogTWF0aC5QSSAqIGwpIC8gX2spICogMzAwKTsKICAgICAgdC55ID0gTWF0aC5yb3VuZChNYXRoLnNpbigoMiAqIE1hdGguUEkgKiBsKSAvIF9rKSAqIDMwMCk7CiAgICB9KTsKICB9LAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBoZWxwVGV4dDogIlRoZSBEYXRhbW9kZWwgRXhwbG9yZXIgZ2l2ZXMgaW5zaWdodCBhYm91dCB0aGUgdmFyaWFibGVzIGNvbnRhaW5lZCBpbiB0aGUgQ0NETSAoQ29tbW9uIENsaW5pY2FsIERhdGFtb2RlbCkgIisKICAgICAgIllvdSBjYW4gaW5zcGVjdCBzaW5nbGUgbm9kZXMgYnkgcmlnaHQgY2xpY2sgb3Igc2VhcmNoIHRocm91Z2ggdGhlIGdyYXBoIHZpYSB0aGUgbm9kZSBzZWFyY2ggb3IgbW9yZSBhZHZhbmNlZCB0aGUgZnVsbHRleHQgc2VhcmNoLiBFYWNoIGVkZ2UgcmVwcmVzZW50cyB0aGUgcmFsYXRpb25zaGlwIGJldHdlZW4gdHdvIG5vZGVzLiIKICAgICAgKyAiIFBoeXNpY3MgY2FuIGJlIGVuYWJsZWQgYW5kIGRpc2FibGVkIGF0IGFueXRpbWUuIiwKICAgICAgdXBkYXRlOiB0cnVlLAogICAgICB0b3BpY3NfZGljdDogeyJEZW1vZ3JhcGh5IjogIk1hc3RlciIsIAogICAgICAgICAgICAgICAiT3JnYW5pemF0aW9uYWwiOiAiTWFzdGVyIiwgCiAgICAgICAgICAgICAgICJEZW1ldGlhX2Jpb21hcmtlciI6ICJNYXN0ZXIiLCAKICAgICAgICAgICAgICAgIkRlbW9ncmFwaGljcyI6ICJNYXN0ZXIiLAogICAgICAgICAgICAgICAiRGlhZ25vc2lzIjogIk1hc3RlciIsIAogICAgICAgICAgICAgICAiRmFtaWx5IjogIk1hc3RlciIsIAogICAgICAgICAgICAgICAiQk5UIjogIk5QVCIsIAogICAgICAgICAgICAgICAiRkFRIjogIk5QVCIsIAogICAgICAgICAgICAgICAiVE1UIjogIk5QVCIsIAogICAgICAgICAgICAgICAiQ0RSIjogIk5QVCIsIAogICAgICAgICAgICAgICAiTU9DQSI6ICJOUFQiLCAKICAgICAgICAgICAgICAgIkdEUyI6ICJOUFQiLCAKICAgICAgICAgICAgICAgIk5QSSI6ICJOUFQiLCAKICAgICAgICAgICAgICAgIk5QSVEiOiAiTlBUIiwgCiAgICAgICAgICAgICAgICJNZW1vcnkgZGVmaWNpdCI6ICJEZWZpY2l0cyIsIAogICAgICAgICAgICAgICAiTGFuZ3VhZ2UgZGVmaWNpdHMiOiAiRGVmaWNpdHMiLCAKICAgICAgICAgICAgICAgIkV4ZWN1dGl2ZSBkZWZpY2l0cyI6ICJEZWZpY2l0cyIsIAogICAgICAgICAgICAgICAiQXR0ZW50aW9uIGRlZmljaXRzIjogIkRlZmljaXRzIiwgCiAgICAgICAgICAgICAgICJPdGhlciBkZWZpY2l0cyI6ICJEZWZpY2l0cyIsIAogICAgICAgICAgICAgICAiQmxvb2QiOiAiTGFiIiwgCiAgICAgICAgICAgICAgICJDU0YiOiAiTGFiIiwgCiAgICAgICAgICAgICAgICJBdGF4aWEiOiAiQXRheGlhIiwKICAgICAgICAgICAgICAgIlNBUkEgc2NvcmVzIjogIlNBUkEiLAogICAgICAgICAgICAgICAiRGVtZW50aWEiOiAiRGVtZW50aWEiICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgbm9kZXM6IFsKICAgICAgICB7CiAgICAgICAgICBpZDogInJvb3QiLAogICAgICAgICAgbGFiZWw6ICJUaGUgRGF0YSBNb2RlbCBSb290IiwKICAgICAgICAgIGNvbG9yOiB7CiAgICAgICAgICAgIGJhY2tncm91bmQ6ICIjYzU1ZTJkIiwKICAgICAgICAgICAgYm9yZGVyOiAiI2M1NWUyZCIKICAgICAgICAgIH0sCiAgICAgICAgICBmaXhlZDogdHJ1ZSwKICAgICAgICAgIHg6IDAsCiAgICAgICAgICB5OiAwLAogICAgICAgICAgZm9udDogeyBjb2xvcjogIndoaXRlIiB9LAogICAgICAgIH0sCiAgICAgICAgLy8gewogICAgICAgIC8vICAgaWQ6ICJzaXRlIiwKICAgICAgICAvLyAgIGxhYmVsOiAiU0lURSIsCiAgICAgICAgLy8gICBjb2xvcjogIkRhcmtWaW9sZXQiLAogICAgICAgIC8vICAgZml4ZWQ6IHRydWUsCgogICAgICAgIC8vICAgZm9udDogeyBjb2xvcjogIndoaXRlIiB9LAogICAgICAgIC8vIH0sCiAgICAgICAgLy8gewogICAgICAgIC8vICAgaWQ6ICJwaWQiLAogICAgICAgIC8vICAgbGFiZWw6ICJQSUQiLAogICAgICAgIC8vICAgY29sb3I6ICJEYXJrVmlvbGV0IiwKICAgICAgICAvLyAgIGZpeGVkOiB0cnVlLAoKICAgICAgICAvLyAgIGZvbnQ6IHsgY29sb3I6ICJ3aGl0ZSIgfSwKICAgICAgICAvLyB9LAogICAgICAgIC8vIHsKICAgICAgICAvLyAgIGlkOiAidHMiLAogICAgICAgIC8vICAgbGFiZWw6ICJUSU1FU1RBTVAiLAogICAgICAgIC8vICAgZml4ZWQ6IHRydWUsCgogICAgICAgIC8vICAgY29sb3I6ICJEYXJrVmlvbGV0IiwKICAgICAgICAvLyAgIGZvbnQ6IHsgY29sb3I6ICJ3aGl0ZSIgfSwKICAgICAgICAvLyB9LAogICAgICAgIC8vIHsKICAgICAgICAvLyAgIGlkOiAic2luZ3VsYXIiLAogICAgICAgIC8vICAgbGFiZWw6ICJTaW5ndWxhciBQYXRpZW50IGluZm9ybWF0aW9uIiwKICAgICAgICAvLyAgIC8vY2lkOiAibWFzdGVyIiwKICAgICAgICAvLyAgIGNvbG9yOiAiRGFya1Zpb2xldCIsCiAgICAgICAgLy8gICBmaXhlZDogdHJ1ZSwKCiAgICAgICAgLy8gICBmb250OiB7IGNvbG9yOiAid2hpdGUiIH0sCiAgICAgICAgLy8gfSwKICAgICAgICAvLyB7CiAgICAgICAgLy8gICBpZDogImJsb29kIiwKICAgICAgICAvLyAgIGxhYmVsOiAiTGFib3JhdG9yeSBtZWFzdXJlbWVudHMgaW4gYmxvb2QiLAogICAgICAgIC8vICAgLy9jaWQ6ICJCbG9vZCIsCiAgICAgICAgLy8gICBmaXhlZDogdHJ1ZSwKCiAgICAgICAgLy8gICBjb2xvcjogIkRhcmtWaW9sZXQiLAogICAgICAgIC8vICAgZm9udDogeyBjb2xvcjogIndoaXRlIiB9LAogICAgICAgIC8vIH0sCiAgICAgICAgLy8gewogICAgICAgIC8vICAgaWQ6ICJzcGluZWZsdWlkIiwKICAgICAgICAvLyAgIGxhYmVsOiAiTGFib3JhdG9yeSBtZWFzdXJlbWVudHMgaW4gY2VyZWJyYWwgc3BpbmUgZmx1aWQiLAogICAgICAgIC8vICAgLy9jaWQ6ICJDU0YiLAogICAgICAgIC8vICAgY29sb3I6ICJEYXJrVmlvbGV0IiwKICAgICAgICAvLyAgIGZpeGVkOiB0cnVlLAoKICAgICAgICAvLyAgIGZvbnQ6IHsgY29sb3I6ICJ3aGl0ZSIgfSwKICAgICAgICAvLyB9LAogICAgICAgIC8vIHsKICAgICAgICAvLyAgIGlkOiAibmV1cm90ZXN0IiwKICAgICAgICAvLyAgIGxhYmVsOiAiTmV1cm9wc3ljaG9sb2dpY2FsIHRlc3Qgc2NvcmVzIiwKICAgICAgICAvLyAgIGNvbG9yOiAiRGFya1Zpb2xldCIsCiAgICAgICAgLy8gICAvL2NpZDogIk5QVCIsCiAgICAgICAgLy8gICBmaXhlZDogdHJ1ZSwKCiAgICAgICAgLy8gICBmb250OiB7IGNvbG9yOiAid2hpdGUiIH0sCiAgICAgICAgLy8gfSwKICAgICAgICAvLyB7CiAgICAgICAgLy8gICBpZDogInF1YWxpZm5ldXJvdGVzdCIsCiAgICAgICAgLy8gICBsYWJlbDogIlF1YWxpZmlhYmxlIG5ldXJvcHN5Y2hvbG9naWNhbCBkaXN0dXJiYW5jZXMiLAogICAgICAgIC8vICAgY29sb3I6ICJEYXJrVmlvbGV0IiwKICAgICAgICAvLyAgIC8vY2lkOiAiRGlzdHVyYmFuY2VzIiwKICAgICAgICAvLyAgIGZpeGVkOiB0cnVlLAoKICAgICAgICAvLyAgIGZvbnQ6IHsgY29sb3I6ICJ3aGl0ZSIgfSwKICAgICAgICAvLyB9LAogICAgICAgIC8vIHsKICAgICAgICAvLyAgIGlkOiAiYXRheGlhIiwKICAgICAgICAvLyAgIGxhYmVsOiAiQXRheGlhIiwKICAgICAgICAvLyAgIGNvbG9yOiAiRGFya1Zpb2xldCIsCiAgICAgICAgLy8gICBmaXhlZDogdHJ1ZSwKCiAgICAgICAgLy8gICBmb250OiB7IGNvbG9yOiAid2hpdGUiIH0sCiAgICAgICAgLy8gfSwKICAgICAgICAvLyB7CiAgICAgICAgLy8gICBpZDogInNhcmEiLAogICAgICAgIC8vICAgbGFiZWw6ICJTQVJBIiwKICAgICAgICAvLyAgIGNvbG9yOiAiRGFya1Zpb2xldCIsCiAgICAgICAgLy8gICBmaXhlZDogdHJ1ZSwKCiAgICAgICAgLy8gICBmb250OiB7IGNvbG9yOiAid2hpdGUiIH0sCiAgICAgICAgLy8gfSwKICAgICAgICAvLyB7CiAgICAgICAgLy8gICBpZDogInNhcmFfc3Vic2NvcmVzIiwKICAgICAgICAvLyAgIGxhYmVsOiAiU0FSQSBTdWJzY29yZXMiLAogICAgICAgIC8vICAgY29sb3I6ICJEYXJrVmlvbGV0IiwKICAgICAgICAvLyAgIGZpeGVkOiB0cnVlLAoKICAgICAgICAvLyAgIGZvbnQ6IHsgY29sb3I6ICJ3aGl0ZSIgfSwKICAgICAgICAvLyB9LAogICAgICAgIC8vIHsKICAgICAgICAvLyAgIGlkOiAic2FyYV9zY29yZXMiLAogICAgICAgIC8vICAgbGFiZWw6ICJTQVJBIFNjb3JlcyIsCiAgICAgICAgLy8gICBjb2xvcjogIkRhcmtWaW9sZXQiLAogICAgICAgIC8vICAgZml4ZWQ6IHRydWUsCgogICAgICAgIC8vICAgZm9udDogeyBjb2xvcjogIndoaXRlIiB9LAogICAgICAgIC8vIH0sCiAgICAgICAgLy8gLy8gLHsKICAgICAgICAvLyAvLyAgIGlkOiJzY2FfY2hhcmFjdGVyaXphdGlvbiIsCiAgICAgICAgLy8gLy8gICBsYWJlbDogIlNDQSBDSEFSQUNURVJJWkFUSU9OIiwKICAgICAgICAvLyAvLyAgIGZpeGVkOiB0cnVlLAogICAgICAgIC8vIC8vICAgeDogLTIxMCwKICAgICAgICAvLyAvLyAgIHk6IC0xMTAsCiAgICAgICAgLy8gLy8gICBmb250OiB7IGNvbG9yOiAid2hpdGUiIH0sCiAgICAgICAgLy8gLy8gfQogICAgICBdLAogICAgICBlZGdlczogWwogICAgICAgIC8vIHsgZnJvbTogInNpdGUiLCB0bzogInJvb3QiLCBjb2xvcjogImJsdWUiIH0sCiAgICAgICAgLy8geyBmcm9tOiAic3BpbmVmbHVpZCIsIHRvOiAicm9vdCIsIGNvbG9yOiAiYmx1ZSIgfSwKICAgICAgICAvLyB7IGZyb206ICJwaWQiLCB0bzogInJvb3QiLCBjb2xvcjogImJsdWUiIH0sCiAgICAgICAgLy8geyBmcm9tOiAidHMiLCB0bzogInJvb3QiLCBjb2xvcjogImJsdWUiIH0sCiAgICAgICAgLy8geyBmcm9tOiAiYmxvb2QiLCB0bzogInJvb3QiLCBjb2xvcjogImJsdWUiIH0sCiAgICAgICAgLy8geyBmcm9tOiAibmV1cm90ZXN0IiwgdG86ICJyb290IiwgY29sb3I6ICJibHVlIiB9LAogICAgICAgIC8vIHsgZnJvbTogInNpbmd1bGFyIiwgdG86ICJyb290IiwgY29sb3I6ICJibHVlIiB9LAogICAgICAgIC8vIHsgZnJvbTogInF1YWxpZm5ldXJvdGVzdCIsIHRvOiAicm9vdCIsIGNvbG9yOiAiYmx1ZSIgfSwKICAgICAgXSwKICAgICAgbWVudVZpZXc6ICIiLAogICAgICBvcHRpb25zOiB7CiAgICAgICAgbm9kZXM6IHsKICAgICAgICAgIGJvcmRlcldpZHRoOiA0LAogICAgICAgICAgY29sb3I6IHsKICAgICAgICAgICAgaGlnaGxpZ2h0OiB7CiAgICAgICAgICAgICAgYmFja2dyb3VuZDogInJlZCIsCiAgICAgICAgICAgIH0sCiAgICAgICAgICB9LAogICAgICAgIH0sCiAgICAgICAgZWRnZXM6IHsKICAgICAgICAgIGNvbG9yOiAibGlnaHRncmF5IiwKCiAgICAgICAgICBhcnJvd3M6IHsKICAgICAgICAgICAgdG86IHsgZW5hYmxlZDogdHJ1ZSwgc2NhbGVGYWN0b3I6IDEsIHR5cGU6ICJhcnJvdyIgfSwKICAgICAgICAgIH0sCiAgICAgICAgfSwKICAgICAgICBoZWlnaHQ6ICh3aW5kb3cuaW5uZXJIZWlnaHQgKiAwLjkpLnRvU3RyaW5nKCksCiAgICAgICAgd2lkdGg6ICh3aW5kb3cuaW5uZXJXaWR0aCAqIDAuOTkpLnRvU3RyaW5nKCksCgogICAgICAgIHBoeXNpY3M6IHsKICAgICAgICAgIGVuYWJsZWQ6IHRydWUsCiAgICAgICAgICBzb2x2ZXI6ICJiYXJuZXNIdXQiLAogICAgICAgIH0sCiAgICAgICAgbWFuaXB1bGF0aW9uOiB0cnVlLAogICAgICB9LAogICAgICBzdWJfbm9kZXM6IFtdLAogICAgICBzdWJfZWRnZXM6IFtdLAogICAgICBzdWJfb3B0aW9uczogewogICAgICAgIG5vZGVzOiB7CiAgICAgICAgICBib3JkZXJXaWR0aDogNCwKICAgICAgICB9LAogICAgICAgIGVkZ2VzOiB7CiAgICAgICAgICBjb2xvcjogImJsYWNrIiwKCiAgICAgICAgICBhcnJvd3M6IHsKICAgICAgICAgICAgdG86IHsgZW5hYmxlZDogdHJ1ZSwgc2NhbGVGYWN0b3I6IDEsIHR5cGU6ICJhcnJvdyIgfSwKICAgICAgICAgIH0sCiAgICAgICAgfSwKICAgICAgICBoZWlnaHQ6ICh3aW5kb3cuaW5uZXJIZWlnaHQgKiAwLjUpLnRvU3RyaW5nKCksCiAgICAgICAgcGh5c2ljczogewogICAgICAgICAgZW5hYmxlZDogdHJ1ZSwKICAgICAgICAgIHNvbHZlcjogImJhcm5lc0h1dCIsCiAgICAgICAgfSwKICAgICAgfSwKICAgIH07CiAgfSwKICB1cGRhdGVkKCkgewogICAgY29uc3QgdGhpc19ub2RlcyA9IHRoaXMubm9kZXM7CiAgICBjb25zdCBuZXR3b3JrID0gdGhpcy4kcmVmcy5uZXR3b3JrOwogICAgZnVuY3Rpb24gc2VsZWN0VGhpc05vZGUobm9kZUlkKSB7CiAgICAgIHZhciBmaW5kTm9kZXNSZXR1cm4gPSBuZXR3b3JrLmZpbmROb2RlKG5vZGVJZCk7CiAgICAgIGlmIChuZXR3b3JrLmlzQ2x1c3RlcihmaW5kTm9kZXNSZXR1cm5bMF0pKSB7CiAgICAgICAgbmV0d29yay5vcGVuQ2x1c3RlcihmaW5kTm9kZXNSZXR1cm5bMF0pOwogICAgICAgIHJldHVybiBzZWxlY3RUaGlzTm9kZSgpOwogICAgICB9CiAgICAgIG5ldHdvcmsuZm9jdXMobm9kZUlkKTsKICAgICAgbmV0d29yay5zZWxlY3ROb2Rlcyhbbm9kZUlkXSwgW3RydWVdKTsKICAgICAgcmV0dXJuOwogICAgfQogICAgaWYgKHRoaXMudXBkYXRlKSB7CiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJsb2FkZXJfdGV4dCIpLmlubmVySFRNTCA9ICJDbHVzdGVyaW5nIE5vZGVzLi4uIjsKICAgICAgY29uc29sZS5sb2coIlVQREFUSU5HLi4iKTsKCiAgICAgIC8vIE5FVFdPUksgUFJPUEVSVElFUwogICAgICAvL2NvbnNvbGUubG9nKHRoaXMudG9waWNzX2FsbCk7CgogICAgICAvLyBDT1JFIENMVVNURVJJTkcKICAgICAgLy8gdmFyIG9wdGlvbnNfY29yZSA9IHsKICAgICAgLy8gICBqb2luQ29uZGl0aW9uOiBmdW5jdGlvbiAobm9kZU9wdGlvbnMpIHsKICAgICAgLy8gICAgIHJldHVybiBub2RlT3B0aW9ucy5jaWQgPT09ICJjb3JlIjsKICAgICAgLy8gICB9LAogICAgICAvLyAgIGNsdXN0ZXJOb2RlUHJvcGVydGllczogewogICAgICAvLyAgICAgaWQ6ICJjaWRDbHVzdGVyIiwKICAgICAgLy8gICAgIGJvcmRlcldpZHRoOiAzLAogICAgICAvLyAgICAgc2hhcGU6ICJjaXJjbGUiLAogICAgICAvLyAgICAgbGFiZWw6ICJDb3JlIE1vZGVsIiwKICAgICAgLy8gICB9LAogICAgICAvLyB9OwoKICAgICAgLy8gdGhpcy4kcmVmcy5uZXR3b3JrLmNsdXN0ZXIob3B0aW9uc19jb3JlKTsKCiAgICAgIC8vIENMVVNURVJJTkcgdmlhIFRPUElDUwoKICAgICAgdmFyIG9wdGlvbnNfdG9waWNzID0gW107CiAgICAgIHRoaXMudG9waWNzX2FsbC5mb3JFYWNoKGZ1bmN0aW9uICh0b3BpYykgewogICAgICAgIHZhciBvcHRpb25zX3RvcGljID0gewogICAgICAgICAgam9pbkNvbmRpdGlvbjogZnVuY3Rpb24gKG5vZGVPcHRpb25zKSB7CiAgICAgICAgICAgIC8vY29uc29sZS5sb2coIkhBTExPSEFMTE8iKTsKICAgICAgICAgICAgcmV0dXJuIG5vZGVPcHRpb25zLmNpZCA9PSB0b3BpYzsKICAgICAgICAgIH0sCiAgICAgICAgICBjbHVzdGVyTm9kZVByb3BlcnRpZXM6IHsKICAgICAgICAgICAgaWQ6ICJjaWRDbHVzdGVyXyIgKyB0b3BpYywKICAgICAgICAgICAgYm9yZGVyV2lkdGg6IDMsCiAgICAgICAgICAgIHNoYXBlOiAic3F1YXJlIiwKICAgICAgICAgICAgY29sb3I6IHsKICAgICAgICAgICAgICBiYWNrZ3JvdW5kOiAiIzFkNmU4OCIsCiAgICAgICAgICAgICAgYm9yZGVyOiAiIzFkNmU4OCIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgbGFiZWw6IHRvcGljLAogICAgICAgICAgfSwKICAgICAgICB9OwogICAgICAgIG9wdGlvbnNfdG9waWNzLnB1c2gob3B0aW9uc190b3BpYyk7CiAgICAgICAgLy8gY29uc29sZS5sb2codG9waWMgKyAiIGNsdXN0ZXJpbmcuLi4iKTsKICAgICAgICAvLyB0aGlzLiRyZWZzLm5ldHdvcmsuY2x1c3RlcihvcHRpb25zX3RvcGljKTsKICAgICAgfSk7CiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgb3B0aW9uc190b3BpY3MubGVuZ3RoOyBpKyspIHsKICAgICAgICB0aGlzLiRyZWZzLm5ldHdvcmsuY2x1c3RlcihvcHRpb25zX3RvcGljc1tpXSk7CiAgICAgIH0KCiAgICAgIC8vIENMVVNURVJJTkcgdmlhIFNPVVJDRVMKCiAgICAgIHZhciBvcHRpb25zX3NvdXJjZXMgPSBbXTsKICAgICAgdGhpcy5zb3VyY2VzX2FsbC5mb3JFYWNoKGZ1bmN0aW9uIChzb3VyY2UpIHsKICAgICAgICB2YXIgb3B0aW9uc19zb3VyY2UgPSB7CiAgICAgICAgICBqb2luQ29uZGl0aW9uOiBmdW5jdGlvbiAobm9kZU9wdGlvbnMpIHsKICAgICAgICAgICAgLy9jb25zb2xlLmxvZygiSEFMTE9IQUxMTyIpOwogICAgICAgICAgICByZXR1cm4gbm9kZU9wdGlvbnMuY2lkID09IHNvdXJjZTsKICAgICAgICAgIH0sCiAgICAgICAgICBjbHVzdGVyTm9kZVByb3BlcnRpZXM6IHsKICAgICAgICAgICAgaWQ6ICJjaWRDbHVzdGVyXyIgKyBzb3VyY2UsCiAgICAgICAgICAgIGJvcmRlcldpZHRoOiAzLAogICAgICAgICAgICBzaGFwZTogInNxdWFyZSIsCiAgICAgICAgICAgIGxhYmVsOiBzb3VyY2UsCiAgICAgICAgICAgIGNvbG9yOiB7CiAgICAgICAgICAgICAgYmFja2dyb3VuZDogIiNjMmFkNGIiLAogICAgICAgICAgICAgIGJvcmRlcjogIiNjMmFkNGIiCiAgICAgICAgICAgIH0sCiAgICAgICAgICB9LAogICAgICAgIH07CiAgICAgICAgb3B0aW9uc19zb3VyY2VzLnB1c2gob3B0aW9uc19zb3VyY2UpOwogICAgICAgIC8vIGNvbnNvbGUubG9nKHRvcGljICsgIiBjbHVzdGVyaW5nLi4uIik7CiAgICAgICAgLy8gdGhpcy4kcmVmcy5uZXR3b3JrLmNsdXN0ZXIob3B0aW9uc190b3BpYyk7CiAgICAgIH0pOwogICAgICBmb3IgKHZhciBwID0gMDsgcCA8IG9wdGlvbnNfc291cmNlcy5sZW5ndGg7IHArKykgewogICAgICAgIHRoaXMuJHJlZnMubmV0d29yay5jbHVzdGVyKG9wdGlvbnNfc291cmNlc1twXSk7CiAgICAgIH0KCiAgICAgIGxldCBhdXRvQ29tcGxldGVEYXRhID0ge307CiAgICAgIHRoaXMubm9kZXMuZm9yRWFjaCgobm9kZSkgPT4gewogICAgICAgIGF1dG9Db21wbGV0ZURhdGFbbm9kZS5sYWJlbF0gPSBudWxsOwogICAgICB9KTsKCiAgICAgIHZhciBhdXRvQ29tcGxldGVPcHRpb25zID0gewogICAgICAgIGRhdGE6IGF1dG9Db21wbGV0ZURhdGEsCiAgICAgICAgb25BdXRvY29tcGxldGU6IGZ1bmN0aW9uIChwYXJhbXMpIHsKICAgICAgICAgIHZhciBub2RlID0gdGhpc19ub2Rlcy5maW5kKChub2RlKSA9PiB7CiAgICAgICAgICAgIHJldHVybiBub2RlLmxhYmVsID09IHBhcmFtczsKICAgICAgICAgIH0pOwoKICAgICAgICAgIHNlbGVjdFRoaXNOb2RlKG5vZGUuaWQpOwogICAgICAgIH0sCiAgICAgIH07CgogICAgICB2YXIgZWxlbXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCIuYXV0b2NvbXBsZXRlIik7CiAgICAgIE0uQXV0b2NvbXBsZXRlLmluaXQoZWxlbXMsIGF1dG9Db21wbGV0ZU9wdGlvbnMpOwoKICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImxvYWRlciIpLnN0eWxlID0gImRpc3BsYXk6IG5vbmUiOwoKICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIm5ldHdvcmtfZGl2Iikuc3R5bGUgPSAidmlzaWJpbGl0eTogdmlzaWJsZSI7CgogICAgICAvL3RoaXMuZWRnZXMgPSBbLi4ubmV3IFNldCh0aGlzLmVkZ2VzKV07CgogICAgICAvL2NvbnNvbGUubG9nKHRoaXMuJHJlZnMubmV0d29yayk7CiAgICAgIC8vIENMVVNURVJJTkcKICAgICAgdGhpcy51cGRhdGUgPSBmYWxzZTsKICAgIH0gZWxzZSB7CiAgICAgIGNvbnNvbGUubG9nKCJwcmV2ZW50ZWQgdXBkYXRpbmcuLi4iKTsKICAgIH0KICB9LAp9Owo="},{"version":3,"sources":["DataModelGraph.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6RA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"DataModelGraph.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <div>\n    <br />\n    <br />\n    <div id=\"loader\">\n      <div class=\"preloader-wrapper big active\">\n        <div class=\"spinner-layer spinner-blue-only\">\n          <div class=\"circle-clipper left\">\n            <div class=\"circle\"></div>\n          </div>\n          <div class=\"gap-patch\">\n            <div class=\"circle\"></div>\n          </div>\n          <div class=\"circle-clipper right\">\n            <div class=\"circle\"></div>\n          </div>\n        </div>\n      </div>\n      <div id=\"loader_text\">Initializing Network...</div>\n    </div>\n    <div id=\"network_div\" style=\"visibility: hidden\">\n      <!-- Modal Structure -->\n      <div id=\"modal1\" class=\"modal\">\n        <div class=\"modal-content\" id=\"modalContent\">\n          <h4 id=\"headerModal\"></h4>\n          <p id=\"textModal\"></p>\n        </div>\n        <div class=\"modal-footer\">\n          <a\n            href=\"#!\"\n            class=\"modal-close waves-effect waves-green btn-flat blue-grey lighten-1\"\n            >Close</a\n          >\n        </div>\n      </div>\n      <div id=\"modal2\" class=\"modal\">\n        <div class=\"modal-content\" id=\"modalContent2\">\n          <h4 id=\"headerModal2\"></h4>\n          <p id=\"textModal2\">\n            <network\n              ref=\"sub_network\"\n              :nodes=\"sub_nodes\"\n              :edges=\"sub_edges\"\n              :options=\"sub_options\"\n              :events=\"['doubleClick', 'oncontext', 'click']\"\n              @double-click=\"onNodeClick\"\n              @oncontext=\"onContextClickSub\"\n              @click=\"generalClick\"\n            ></network>\n          </p>\n        </div>\n        <div class=\"modal-footer\">\n          <a\n            href=\"#!\"\n            class=\"modal-close waves-effect waves-green btn-flat blue-grey lighten-1\"\n            >Close</a\n          >\n        </div>\n      </div>\n      <div id=\"modal_fulltext\" class=\"modal\">\n        <div class=\"modal-content\">\n          <h4>Fulltext Search</h4>\n          <p>\n            Search through all descriptions, tooltips and definitions of the\n            datmodel.\n          </p>\n          <div class=\"row\">\n            <form id=\"fulltext_form\">\n              <div class=\"input-field col s10\">\n                <input type=\"text\" required name=\"text\" id=\"fulltext_input\" />\n              </div>\n              <div class=\"col s2\">\n                <button class=\"waves-effect btn blue-grey lighten-1\">Go</button>\n              </div>\n            </form>\n          </div>\n          <div class=\"row\" id=\"fulltext_result\"></div>\n        </div>\n      </div>\n      <div>\n        <div class=\"row\" style=\"margin-bottom: 3px;\">\n          <div class=\"col s4\"></div>\n          <div class=\"col s4\">\n        <h2 style=\"margin-top: 0\" class=\"center-align\">Model Explorer <i class=\"small material-icons tooltipped\" data-position=\"bottom\" :data-tooltip=\"helpText\">help_outline</i></h2>\n        </div>\n        <div class=\"col s4 right\">\n          <button class=\"waves-effect waves-light btn blue-grey lighten-1\" id=\"hideNavBtn\" @click=\"hideNav()\">Hide Navigation</button>\n          <button class=\"waves-effect waves-light btn blue-grey lighten-1 hide\" id=\"showNavBtn\" @click=\"showNav()\">Show Navigation</button>\n        </div>\n        </div>\n       \n\n        <div class=\"row valign-wrapper\" id=\"top_nav_div\">\n          \n          <div class=\"col s2\">\n            <button\n              @click=\"disablePhysics\"\n              class=\"waves-effect waves-light btn blue-grey lighten-1 left\"\n            >\n              Disable Physics</button\n            ><br /><br />\n            <button\n              @click=\"enablePhysics\"\n              class=\"waves-effect waves-light btn blue-grey lighten-1 left\"\n            >\n              Enable Physics</button\n            ><br />\n            <br />\n            <button\n              @click=\"clusterAll\"\n              class=\"waves-effect waves-light btn blue-grey lighten-1 left\"\n            >\n              Close all Clusters</button\n            ><br />\n          \n          </div>\n\n          \n          <div class=\"col s4\">\n            <div class=\"row\">\n              <div class=\"input-field col s12\">\n                <i class=\"material-icons prefix\">textsms</i>\n                <input\n                  type=\"text\"\n                  id=\"autocomplete-input\"\n                  class=\"autocomplete\"\n                />\n                <label for=\"autocomplete-input\">Search for Nodes...</label>\n              </div>\n              <div class=\"col s12\">or</div>\n              <br />\n              <div class=\"col s12\">\n                <div\n                  @click=\"fulltextSearch\"\n                  class=\"btn blue-grey lighten-1\"\n                  id=\"fulltext_btn\"\n                >\n                  Fulltext Search\n                </div>\n              </div>\n            </div>\n          </div>\n\n\n          <div class=\"col s6\">\n             LEGEND\n            <table class=\"striped\">\n              <thead>\n                <tr>\n                <th>Clusters and Nodes</th>\n                <th>Edges</th>\n                </tr>\n              </thead>\n              <tbody>\n                <tr>\n\n                  <td><a\n              style=\"\n                background-color: #1d6e88;\n                color: white;\n                padding-left: 18px;\n                padding-right: 18px;\n                margin: 4px;\n                \n              \"\n              ></a\n            >\n            = data root groups; internal variables with available mappings\n                  </td>\n                  <td>\n\n                    <a  style=\"\n                background-color: black;\n                color: black;\n                padding-left: 18px;\n                padding-right: 18px;\n                margin: 4px;\n              \"></a> = part_of <br />\n        \n\n                  </td>\n                </tr>\n                <tr>\n\n                  <td><a\n              style=\"\n                background-color: #00bcbd;\n                color: black;\n                padding-left: 18px;\n                padding-right: 18px;\n                margin: 4px;\n              \"\n              ></a\n            >\n            = attributes by sources; external variables</td>\n            <td>\n\n                  <a\n              style=\"\n                background-color: blue;\n                color: white;\n                padding-right: 18px;\n                padding-left: 18px;\n                margin: 4px;\n              \"\n              ></a\n            >\n            = maps_to\n\n            </td>\n\n                </tr>\n                <tr>\n                  <td>\n                     <a\n              style=\"\n                background-color: #c2ad4b;\n                color: black;\n                padding-left: 18px;\n                padding-right: 18px;\n                margin: 4px;\n              \"\n              ></a\n            >\n            = sources\n\n                  </td>\n                  <td>\n                       <a\n              style=\"\n                background-color: gray;\n                color: black;\n                padding: 4px;\n                margin: 4px;\n              \"\n              >dashed</a\n            >\n            = variable_in\n                  </td>\n                </tr>\n                <tr><td>\n                  <a\n              style=\"\n                background-color: #c55e2d;\n                color: black;\n                padding-left: 18px;\n                padding-right: 18px;\n                margin: 4px;\n              \"\n              ></a\n            >\n            = root nodes\n                  </td></tr>\n            \n\n              </tbody>\n           \n          <br />\n         \n            \n            </table>\n          </div>\n        </div>\n      </div>\n      <network class=\"mynetwork\"\n        ref=\"network\"\n        :nodes=\"nodes\"\n        :edges=\"edges\"\n        :options=\"options\"\n        :events=\"['doubleClick', 'oncontext', 'click']\"\n        @double-click=\"onNodeClick\"\n        @oncontext=\"onContextClick\"\n        @click=\"generalClick\"\n      ></network>\n\n      <div class=\"menu\" id=\"rightClickMenu\">\n        <ul class=\"menu-options\" id=\"rightMenuList\">\n          <component v-if=\"menuView\" :is=\"menuView\"></component>\n        </ul>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport ax from \"axios\";\nconst axios = ax;\nimport M from \"materialize-css\";\n\nexport default {\n  name: \"graph\",\n  methods: {\n    hideNav: function(){\n      document.getElementById(\"top_nav_div\").style.display = \"none\"; \n      document.getElementById(\"hideNavBtn\").classList.add(\"hide\");\n      document.getElementById(\"showNavBtn\").classList.remove(\"hide\");\n\n    },\n    showNav: function(){\n      document.getElementById(\"top_nav_div\").style.display = \"flex\";\n      document.getElementById(\"showNavBtn\").classList.add(\"hide\");\n      document.getElementById(\"hideNavBtn\").classList.remove(\"hide\");\n    },\n\n    userKeyboard: function (e) {\n      if (e.keyCode == 70 && e.ctrlKey) {\n        alert(\"ctrl F\");\n      }\n    },\n    clusterAll: function () {\n      // CLUSTERING via TOPICS\n\n      var options_topics = [];\n      this.topics_all.forEach(function (topic) {\n        var options_topic = {\n          joinCondition: function (nodeOptions) {\n            //console.log(\"HALLOHALLO\");\n            return nodeOptions.cid == topic;\n          },\n          clusterNodeProperties: {\n            id: \"cidCluster_\" + topic,\n            borderWidth: 3,\n            shape: \"square\",\n\n            label: topic,\n          },\n        };\n        options_topics.push(options_topic);\n        // console.log(topic + \" clustering...\");\n        // this.$refs.network.cluster(options_topic);\n      });\n      for (var i = 0; i < options_topics.length; i++) {\n        this.$refs.network.cluster(options_topics[i]);\n      }\n\n      // CLUSTERING via SOURCES\n\n      var options_sources = [];\n      this.sources_all.forEach(function (source) {\n        var options_source = {\n          joinCondition: function (nodeOptions) {\n            //console.log(\"HALLOHALLO\");\n            return nodeOptions.cid == source;\n          },\n          clusterNodeProperties: {\n            id: \"cidCluster_\" + source,\n            borderWidth: 3,\n            shape: \"square\",\n            label: source,\n            color: {\n              background: \"#c2ad4b\",\n              border: \"#c2ad4b\"\n            },\n          },\n        };\n        options_sources.push(options_source);\n        // console.log(topic + \" clustering...\");\n        // this.$refs.network.cluster(options_topic);\n      });\n      for (var p = 0; p < options_sources.length; p++) {\n        this.$refs.network.cluster(options_sources[p]);\n      }\n    },\n    generalClick: function () {\n      const menu = document.getElementById(\"rightClickMenu\");\n      if (menu.style.display == \"block\") {\n        menu.style.display = \"none\";\n      }\n    },\n    onContextClickSub: function (params) {\n      document.getElementById(\"rightMenuList\").innerHTML = \"\";\n      if (params.nodes.length == 1) {\n        const e = params.event;\n        e.preventDefault();\n\n        const menu = document.getElementById(\"rightClickMenu\");\n        var pagex = e.pageX;\n        var pagey = e.pageY;\n        menu.style.left = `${pagex}px`;\n        menu.style.top = `${pagey}px`;\n        menu.style.display = \"block\";\n        document.getElementById(\"rightMenuList\").innerHTML = \"\";\n\n        if (this.$refs.network.isCluster(params.nodes[0])) {\n          console.error(\"cluster occured in sub graph...\");\n        } else {\n          [\"Inspect\", \"Show more in OLS\"].forEach((s) => {\n            var listelemNode = document.createElement(\"li\");\n            listelemNode.classList.add(\"menu-option\");\n            var btn = document.createElement(\"button\");\n            btn.classList.add(\"btn\");\n            btn.classList.add(\"waves-effect\");\n            btn.classList.add(\"blue-grey\", \"lighten-1\");\n            btn.style.height = \"auto\";\n            btn.style.width = \"auto\";\n            btn.style.margin = \"2px\";\n            var textNode = document.createTextNode(s);\n            if (s == \"Inspect\") {\n              btn.onclick = function () {\n                var getParams = {};\n                if (params.nodes[0].startsWith(\"attr_\")) {\n                  getParams[\"type\"] = \"attribute\";\n                  getParams[\"node\"] = params.nodes[0].replace(\"attr_\", \"\");\n                } else if (params.nodes[0].startsWith(\"sources_\")) {\n                  getParams[\"type\"] = \"source\";\n                  getParams[\"node\"] = params.nodes[0].replace(\"sources_\", \"\");\n                } else {\n                  getParams[\"type\"] = \"core\";\n                  getParams[\"node\"] = params.nodes[0];\n                }\n                const attributeInformation = axios.get(\n                  process.env.VUE_APP_CLINICALURL + \"/get/attribute\",\n                  { params: getParams }\n                );\n\n                attributeInformation.then((data) => {\n                  var elem = document.getElementById(\"modal1\");\n                  var instance = M.Modal.getInstance(elem);\n                  var modalHeader = document.getElementById(\"headerModal\");\n\n                  modalHeader.textContent =\n                    \"Variable Name: \" + getParams[\"node\"];\n                  var modalText = document.getElementById(\"textModal\");\n                  modalText.innerHTML = \"\";\n\n                  if (data[\"data\"][\"information\"] == \"none\") {\n                    modalText.appendChild(\n                      document.createTextNode(\n                        \"No information available in Clinical Backend...\"\n                      )\n                    );\n                    menu.style.display = \"none\";\n                    instance.open();\n                  } else {\n                    var data_as_json = JSON.parse(\n                      data[\"data\"][\"information\"]\n                    )[0][\"fields\"];\n\n                    var keys = Object.keys(data_as_json);\n\n                    var tbl = document.createElement(\"table\");\n                    tbl.style.width = \"100%\";\n                    tbl.setAttribute(\"border\", \"1\");\n                    var tbdy = document.createElement(\"tbody\");\n                    keys.forEach(function (value) {\n                      var row = document.createElement(\"tr\");\n                      var cell1 = document.createElement(\"td\");\n                      var cell2 = document.createElement(\"td\");\n                      cell1.appendChild(document.createTextNode(value));\n\n                      cell2.appendChild(\n                        document.createTextNode(data_as_json[value])\n                      );\n                      row.appendChild(cell1);\n                      row.appendChild(cell2);\n                      tbdy.appendChild(row);\n                    });\n\n                    tbl.appendChild(tbdy);\n\n                    modalText.appendChild(tbl);\n                    menu.style.display = \"none\";\n                    instance.open();\n                  }\n                });\n                //console.log(attributeInformation);\n              };\n            }\n            if (s == \"Show more in OLS\") {\n              btn.onclick = function () {\n                window.open(\n                  process.env.VUE_APP_OLSURL +\n                    \"search?q=\" +\n                    params.nodes[0].replace(\"attr_\", \"\"),\n                  \"popUpWindow\",\n                  \"height=800,width=1200,left=10,top=10,,scrollbars=yes,menubar=no\"\n                );\n                return false;\n              };\n            }\n\n            btn.appendChild(textNode);\n            listelemNode.appendChild(btn);\n            menu.firstChild.appendChild(listelemNode);\n          });\n        }\n      } else {\n        if (params.edges.length == 1) {\n          var btn = document.createElement(\"button\");\n          var edge = params.edges[0];\n          const e = params.event;\n          e.preventDefault();\n\n          const menu = document.getElementById(\"rightClickMenu\");\n          pagex = e.pageX;\n          pagey = e.pageY;\n          menu.style.left = `${pagex}px`;\n          menu.style.top = `${pagey}px`;\n          menu.style.display = \"block\";\n          document.getElementById(\"rightMenuList\").innerHTML = \"\";\n          const netw = this.$refs.network;\n          var listelemNode = document.createElement(\"li\");\n          listelemNode.classList.add(\"menu-option\");\n          btn = document.createElement(\"button\");\n          btn.classList.add(\"btn\");\n          btn.classList.add(\"waves-effect\");\n          btn.classList.add(\"blue-grey\", \"lighten-1\");\n          btn.style.height = \"auto\";\n          btn.style.width = \"auto\";\n          btn.style.margin = \"2px\";\n          var s = \"Inspect\";\n          var textNode = document.createTextNode(s + \" Edge\");\n          if (s == \"Inspect\") {\n            btn.onclick = async function () {\n              var getParams = {};\n              var connectedNodes = netw.getConnectedNodes(edge);\n              if (\n                connectedNodes[0].toLowerCase().includes(\"cluster\") ||\n                connectedNodes[1].toLowerCase().includes(\"cluster\")\n              ) {\n                M.toast({\n                  html: \"Please Open the cluster before inspecting edges!\",\n                });\n                return;\n              }\n              if (\n                connectedNodes[0].toLowerCase().includes(\"source\") ||\n                connectedNodes[1].toLowerCase().includes(\"source\")\n              ) {\n                M.toast({\n                  html:\n                    \"Mappings of type 'part_of' do not contain more information!\",\n                });\n                return;\n              }\n              getParams[\"attr_1\"] = connectedNodes[0].replace(\"attr_\", \"\");\n              getParams[\"attr_2\"] = connectedNodes[1].replace(\"attr_\", \"\");\n\n              //console.log(connectedNodes);\n\n              const attributeMappingInformation = await axios.get(\n                process.env.VUE_APP_CLINICALURL + \"/get/attribute-mapping\",\n                { params: getParams }\n              );\n              //console.log(attributeMappingInformation);\n              var data = attributeMappingInformation[\"data\"];\n              //console.log(data);\n\n              var elem = document.getElementById(\"modal1\");\n              var instance = M.Modal.getInstance(elem);\n              var modalHeader = document.getElementById(\"headerModal\");\n\n              modalHeader.textContent =\n                \"Variable Mapping: \" +\n                getParams[\"attr_1\"] +\n                \", \" +\n                getParams[\"attr_2\"];\n              var modalText = document.getElementById(\"textModal\");\n              modalText.innerHTML = \"\";\n              if (data[\"information\"] == \"none\") {\n                modalText.appendChild(\n                  document.createTextNode(\n                    \"No information available in Clinical Backend...\"\n                  )\n                );\n                menu.style.display = \"none\";\n                instance.open();\n              } else {\n                var data_as_json = JSON.parse(data[\"information\"])[0][\"fields\"];\n\n                var keys = Object.keys(data_as_json);\n\n                var tbl = document.createElement(\"table\");\n                tbl.style.width = \"100%\";\n                tbl.setAttribute(\"border\", \"1\");\n                var tbdy = document.createElement(\"tbody\");\n                keys.forEach(function (value) {\n                  var row = document.createElement(\"tr\");\n                  var cell1 = document.createElement(\"td\");\n                  var cell2 = document.createElement(\"td\");\n                  cell1.appendChild(document.createTextNode(value));\n\n                  cell2.appendChild(\n                    document.createTextNode(data_as_json[value])\n                  );\n                  row.appendChild(cell1);\n                  row.appendChild(cell2);\n                  tbdy.appendChild(row);\n                });\n\n                tbl.appendChild(tbdy);\n\n                modalText.appendChild(tbl);\n                menu.style.display = \"none\";\n                instance.open();\n              }\n            };\n            btn.appendChild(textNode);\n            listelemNode.appendChild(btn);\n            menu.firstChild.appendChild(listelemNode);\n          }\n        } else {\n          return;\n        }\n      }\n    },\n    onContextClick: function (params) {\n      document.getElementById(\"rightMenuList\").innerHTML = \"\";\n      var pagey;\n      var pagex;\n\n      if (params.nodes.length == 1) {\n        const e = params.event;\n        e.preventDefault();\n\n        const menu = document.getElementById(\"rightClickMenu\");\n        pagex = e.pageX;\n        pagey = e.pageY;\n        menu.style.left = `${pagex}px`;\n        menu.style.top = `${pagey}px`;\n        menu.style.display = \"block\";\n        document.getElementById(\"rightMenuList\").innerHTML = \"\";\n        const netw = this.$refs.network;\n\n        if (this.$refs.network.isCluster(params.nodes[0])) {\n          var listelem = document.createElement(\"li\");\n          listelem.classList.add(\"menu-option\");\n          var text = document.createTextNode(\"Open this Cluster\");\n          var btn = document.createElement(\"button\");\n          btn.classList.add(\"btn\");\n          btn.classList.add(\"waves-effect\");\n          btn.classList.add(\"blue-grey\", \"lighten-1\");\n          btn.style.height = \"auto\";\n          btn.style.width = \"auto\";\n          btn.style.margin = \"2px\";\n          btn.onclick = function () {\n            netw.openCluster(params.nodes[0]);\n            document.getElementById(\"rightClickMenu\").style.display = \"none\";\n          };\n          btn.appendChild(text);\n          listelem.appendChild(btn);\n\n          menu.firstChild.appendChild(listelem);\n        } else {\n          [\"Inspect\", \"Open sub graph\", \"Show more in OLS\"].forEach((s) => {\n            var listelemNode = document.createElement(\"li\");\n            listelemNode.classList.add(\"menu-option\");\n            var btn = document.createElement(\"button\");\n            btn.classList.add(\"btn\");\n            btn.classList.add(\"waves-effect\");\n            btn.classList.add(\"blue-grey\", \"lighten-1\");\n            btn.style.height = \"auto\";\n            btn.style.width = \"auto\";\n            btn.style.margin = \"2px\";\n            var textNode = document.createTextNode(s);\n            if (s == \"Inspect\") {\n              btn.onclick = function () {\n                var getParams = {};\n                if (params.nodes[0].startsWith(\"attr_\")) {\n                  getParams[\"type\"] = \"attribute\";\n                  getParams[\"node\"] = params.nodes[0].replace(\"attr_\", \"\");\n                } else if (params.nodes[0].startsWith(\"sources_\")) {\n                  getParams[\"type\"] = \"source\";\n                  getParams[\"node\"] = params.nodes[0].replace(\"sources_\", \"\");\n                } else {\n                  getParams[\"type\"] = \"core\";\n                  getParams[\"node\"] = params.nodes[0];\n                }\n                const attributeInformation = axios.get(\n                  process.env.VUE_APP_CLINICALURL + \"/get/attribute\",\n                  { params: getParams }\n                );\n\n                attributeInformation.then((data) => {\n                  var elem = document.getElementById(\"modal1\");\n                  var instance = M.Modal.getInstance(elem);\n                  var modalHeader = document.getElementById(\"headerModal\");\n\n                  modalHeader.textContent =\n                    \"Variable Name: \" + getParams[\"node\"];\n                  var modalText = document.getElementById(\"textModal\");\n                  modalText.innerHTML = \"\";\n\n                  if (data[\"data\"][\"information\"] == \"none\") {\n                    modalText.appendChild(\n                      document.createTextNode(\n                        \"No information available in Clinical Backend...\"\n                      )\n                    );\n                    menu.style.display = \"none\";\n                    instance.open();\n                  } else {\n                    var data_as_json = JSON.parse(\n                      data[\"data\"][\"information\"]\n                    )[0][\"fields\"];\n\n                    var keys = Object.keys(data_as_json);\n\n                    var tbl = document.createElement(\"table\");\n                    tbl.style.width = \"100%\";\n                    tbl.setAttribute(\"border\", \"1\");\n                    var tbdy = document.createElement(\"tbody\");\n                    keys.forEach(function (value) {\n                      var row = document.createElement(\"tr\");\n                      var cell1 = document.createElement(\"td\");\n                      var cell2 = document.createElement(\"td\");\n                      cell1.appendChild(document.createTextNode(value));\n\n                      cell2.appendChild(\n                        document.createTextNode(data_as_json[value])\n                      );\n                      row.appendChild(cell1);\n                      row.appendChild(cell2);\n                      tbdy.appendChild(row);\n                    });\n\n                    tbl.appendChild(tbdy);\n\n                    modalText.appendChild(tbl);\n                    menu.style.display = \"none\";\n                    instance.open();\n                  }\n                });\n                //console.log(attributeInformation);\n              };\n            }\n            if (s == \"Show more in OLS\") {\n              btn.onclick = function () {\n                window.open(\n                  process.env.VUE_APP_OLSURL +\n                    \"search?q=\" +\n                    params.nodes[0].replace(\"attr_\", \"\"),\n                  \"popUpWindow\",\n                  \"height=800,width=1200,left=10,top=10,,scrollbars=yes,menubar=no\"\n                );\n                return false;\n              };\n            }\n            if (s == \"Open sub graph\") {\n              //const subnetw = this.$refs.sub_network;\n              this.sub_nodes = [];\n              this.sub_edges = [];\n              var sub_n = this.sub_nodes;\n              var sub_e = this.sub_edges;\n              btn.onclick = function () {\n                var node = params.nodes[0];\n                var connectedNodes = netw.getConnectedNodes(node);\n                connectedNodes.push(node);\n                var connectedEdges = netw.getConnectedEdges(node);\n\n                var instance2 = M.Modal.getInstance(\n                  document.getElementById(\"modal2\")\n                );\n                instance2.open();\n\n                connectedNodes.forEach((node) => {\n                  var n = netw.getNode(node);\n                  if (n != null) {\n                    sub_n.push(n);\n                  }\n                });\n                connectedEdges.forEach((edge) => {\n                  var ed = netw.getEdge(edge);\n                  if (ed != null) {\n                    sub_e.push(ed);\n                  }\n                });\n\n                menu.style.display = \"none\";\n              };\n            }\n\n            btn.appendChild(textNode);\n            listelemNode.appendChild(btn);\n            menu.firstChild.appendChild(listelemNode);\n          });\n        }\n      } else {\n        if (params.edges.length == 1) {\n          var edge = params.edges[0];\n          const e = params.event;\n          e.preventDefault();\n\n          const menu = document.getElementById(\"rightClickMenu\");\n          pagex = e.pageX;\n          pagey = e.pageY;\n          menu.style.left = `${pagex}px`;\n          menu.style.top = `${pagey}px`;\n          menu.style.display = \"block\";\n          document.getElementById(\"rightMenuList\").innerHTML = \"\";\n          const netw = this.$refs.network;\n          var listelemNode = document.createElement(\"li\");\n          listelemNode.classList.add(\"menu-option\");\n          btn = document.createElement(\"button\");\n          btn.classList.add(\"btn\");\n          btn.classList.add(\"waves-effect\");\n          btn.classList.add(\"blue-grey\", \"lighten-1\");\n          btn.style.height = \"auto\";\n          btn.style.width = \"auto\";\n          btn.style.margin = \"2px\";\n          var s = \"Inspect\";\n          var textNode = document.createTextNode(s + \" Edge\");\n          if (s == \"Inspect\") {\n            btn.onclick = async function () {\n              var getParams = {};\n              var connectedNodes = netw.getConnectedNodes(edge);\n              if (\n                connectedNodes[0].toLowerCase().includes(\"cluster\") ||\n                connectedNodes[1].toLowerCase().includes(\"cluster\")\n              ) {\n                M.toast({\n                  html: \"Please Open the cluster before inspecting edges!\",\n                });\n                return;\n              }\n              if (\n                connectedNodes[0].toLowerCase().includes(\"source\") ||\n                connectedNodes[1].toLowerCase().includes(\"source\")\n              ) {\n                M.toast({\n                  html:\n                    \"Mappings of type 'part_of' do not contain more information!\",\n                });\n                return;\n              }\n              getParams[\"attr_1\"] = connectedNodes[0].replace(\"attr_\", \"\");\n              getParams[\"attr_2\"] = connectedNodes[1].replace(\"attr_\", \"\");\n\n              //console.log(connectedNodes);\n\n              const attributeMappingInformation = await axios.get(\n                process.env.VUE_APP_CLINICALURL + \"/get/attribute-mapping\",\n                { params: getParams }\n              );\n              //console.log(attributeMappingInformation);\n              var data = attributeMappingInformation[\"data\"];\n              //console.log(data);\n\n              var elem = document.getElementById(\"modal1\");\n              var instance = M.Modal.getInstance(elem);\n              var modalHeader = document.getElementById(\"headerModal\");\n\n              modalHeader.textContent =\n                \"Variable Mapping: \" +\n                getParams[\"attr_1\"] +\n                \", \" +\n                getParams[\"attr_2\"];\n              var modalText = document.getElementById(\"textModal\");\n              modalText.innerHTML = \"\";\n              if (data[\"information\"] == \"none\") {\n                modalText.appendChild(\n                  document.createTextNode(\n                    \"No information available in Clinical Backend...\"\n                  )\n                );\n                menu.style.display = \"none\";\n                instance.open();\n              } else {\n                var data_as_json = JSON.parse(data[\"information\"])[0][\"fields\"];\n\n                var keys = Object.keys(data_as_json);\n\n                var tbl = document.createElement(\"table\");\n                tbl.style.width = \"100%\";\n                tbl.setAttribute(\"border\", \"1\");\n                var tbdy = document.createElement(\"tbody\");\n                keys.forEach(function (value) {\n                  var row = document.createElement(\"tr\");\n                  var cell1 = document.createElement(\"td\");\n                  var cell2 = document.createElement(\"td\");\n                  cell1.appendChild(document.createTextNode(value));\n\n                  cell2.appendChild(\n                    document.createTextNode(data_as_json[value])\n                  );\n                  row.appendChild(cell1);\n                  row.appendChild(cell2);\n                  tbdy.appendChild(row);\n                });\n\n                tbl.appendChild(tbdy);\n\n                modalText.appendChild(tbl);\n                menu.style.display = \"none\";\n                instance.open();\n              }\n            };\n            btn.appendChild(textNode);\n            listelemNode.appendChild(btn);\n            menu.firstChild.appendChild(listelemNode);\n          }\n        } else {\n          return;\n        }\n      }\n    },\n    clusterOpenAll: function () {\n      for (var node in this.nodes) {\n        if (this.$refs.network.isCluster(node) == true) {\n          this.$refs.network.openCluster(node);\n        }\n      }\n    },\n    onNodeClick: function (params) {\n      console.log(\"Clicked double\");\n      //console.log(\"HALLOHALLO\");\n      if (params.nodes.length == 1) {\n        if (this.$refs.network.isCluster(params.nodes[0]) == true) {\n          this.$refs.network.openCluster(params.nodes[0]);\n        }\n      }\n    },\n    disablePhysics: function () {\n      var opts = this.$refs.network[\"options\"];\n      opts[\"physics\"][\"enabled\"] = false;\n      this.$refs.network.setOptions(opts);\n    },\n    enablePhysics: function () {\n      var opts = this.$refs.network[\"options\"];\n      opts[\"physics\"][\"enabled\"] = true;\n      this.$refs.network.setOptions(opts);\n    },\n    btnClick: function () {\n      var options_topic = {\n        joinCondition: function (nodeOptions) {\n          //console.log(\"HALLOHALLO\");\n          return nodeOptions.cid == this.topics_all[1];\n        },\n        clusterNodeProperties: {\n          id: \"cidCluster_\" + this.topics_all[1],\n          borderWidth: 3,\n          shape: \"circle\",\n          label: this.topics_all[1],\n        },\n      };\n      console.log(\"clustering...\");\n      this.$refs.network.cluster(options_topic);\n    },\n    fulltextSearch: function () {\n      document.getElementById(\"fulltext_result\").innerHTML = \"\";\n      var network = this.$refs.network;\n      var nodes = this.nodes;\n      function selectThisNode(nodeId) {\n        var findNodesReturn = network.findNode(nodeId);\n        if (network.isCluster(findNodesReturn[0])) {\n          network.openCluster(findNodesReturn[0]);\n          return selectThisNode(nodeId);\n        }\n        //console.log(nodeId);\n        network.focus(nodeId);\n        network.selectNodes([nodeId], [true]);\n        // console.log(nodes);\n        var sel = nodes.find((obj) => {\n          return obj[\"id\"] == nodeId;\n        });\n       \n        sel[\"color\"] = {\n          background: \"red\",\n        };\n        \n        network.editNode();\n        return;\n      }\n\n      var fulltext_modal = M.Modal.getInstance(\n        document.getElementById(\"modal_fulltext\")\n      );\n      fulltext_modal.open();\n      document.getElementById(\"fulltext_input\").value = \"\";\n      document.getElementById(\"fulltext_input\").focus();\n      document.getElementById(\"fulltext_form\").onsubmit = async function (e) {\n        e.preventDefault();\n\n        const fulltextResult = await axios({\n          url:\n            process.env.VUE_APP_CLINICALURL +\n            \"/get/fulltext\" +\n            \"?text=\" +\n            document.getElementById(\"fulltext_input\").value,\n        });\n        if (\n          fulltextResult.status == 200 &&\n          fulltextResult[\"data\"][\"result\"].length > 0\n        ) {\n          document.getElementById(\"fulltext_result\").innerHTML = \"\";\n          document\n            .getElementById(\"fulltext_result\")\n            .appendChild(document.createTextNode(\"Search Results: \"));\n          fulltextResult[\"data\"][\"result\"].forEach((result) => {\n            var btn = document.createElement(\"button\");\n            btn.onclick = function () {\n              fulltext_modal.close();\n              //console.log(result);\n              selectThisNode(\"attr_\" + result);\n            };\n            btn.classList.add(\"btn\", \"waves-effect\", \"blue-grey\", \"lighten-1\");\n            btn.innerHTML = result;\n            var row = document.createElement(\"div\");\n            row.classList.add(\"row\");\n            row.appendChild(btn);\n            document.getElementById(\"fulltext_result\").appendChild(row);\n          });\n        } else {\n          document.getElementById(\"fulltext_result\").innerHTML = \"\";\n          document\n            .getElementById(\"fulltext_result\")\n            .appendChild(document.createTextNode(\"No Attribute/s Found...\"));\n        }\n      };\n    },\n  },\n\n  mounted(){\n     document.getElementsByClassName(\"footer-fixed\")[0].style.position = \"relative\";\n  },\n  async created() {\n   \n\n    var elems_tooltip = document.querySelectorAll('.tooltipped');\n    M.Tooltip.init(elems_tooltip);\n    //document.getElementById('loader_text').innerHTML=\"Fetching Attributes...\";\n    const attributes = await axios.get(\n      process.env.VUE_APP_CLINICALURL + \"/get/attributes/all\"\n    );\n    //document.getElementById('loader_text').innerHTML=\"Fetching Sources...\";\n    const sources_all = await axios.get(\n      process.env.VUE_APP_CLINICALURL + \"/get/sources/all\"\n    );\n    //document.getElementById('loader_text').innerHTML=\"Fetching Mappings...\";\n    const attr_mappings = await axios.get(\n      process.env.VUE_APP_CLINICALURL + \"/get/attribute-mappings/all\"\n    );\n\n    var elemsModal = document.querySelectorAll(\".modal\");\n    M.Modal.init(elemsModal);\n\n\n    for(const t in this.topics_dict){\n      if (!this.nodes.filter(e => e.id == this.topics_dict[t]).length > 0) {\n  \n        console.log(\"ADDED:\" + t);\n      \n      this.nodes.push(\n      {\n          id: this.topics_dict[t],\n          label: this.topics_dict[t],\n          color: {\n             background: \"#c55e2d\",\n             border: \"#c55e2d\"\n          },\n          fixed: true,\n\n          font: { color: \"white\" },\n        }\n    );\n    this.edges.push({ from: this.topics_dict[t], to: \"root\", color: \"black\" });\n      }\n  }\n\n\n    var topics = new Set();\n    //console.log(response);\n    var attr = attributes[\"data\"][\"attributes\"];\n    //document.getElementById('loader_text').innerHTML=\"Building graph...\";\n    for (var k = 0; k < attr.length; k++) {\n      //console.log(attr[k][\"topic\"]);\n      topics.add(attr[k][\"topic\"]);\n\n      this.nodes.push({\n        id: \"attr_\" + attr[k][\"name\"],\n        label: attr[k][\"tooltip\"],\n        cid: attr[k][\"topic\"],\n        color: {\n          background: \"#1d6e88\",\n          border: \"#1d6e88\"\n        },\n        font: {\n          color: \"white\"\n        }\n      });\n      for(const t in this.topics_dict){\n        if(t == attr[k][\"topic\"]){\n          this.edges.push({\n            from: \"attr_\" + attr[k][\"name\"],\n            to: this.topics_dict[t],\n\n            color: \"black\",\n          });\n        }\n      }\n      // switch (attr[k][\"topic\"]) {\n      //   case \"Disturbances\":\n      //     this.edges.push({\n      //       from: \"attr_\" + attr[k][\"name\"],\n      //       to: \"qualifneurotest\",\n\n      //       color: \"blue\",\n      //     });\n      //     break;\n      //   case \"master\":\n      //     this.edges.push({\n      //       from: \"attr_\" + attr[k][\"name\"],\n      //       to: \"singular\",\n      //       label: \"part of\",\n\n      //       color: \"blue\",\n      //     });\n      //     break;\n      //   case \"NPT\":\n      //     this.edges.push({\n      //       from: \"attr_\" + attr[k][\"name\"],\n      //       to: \"neurotest\",\n\n      //       color: \"blue\",\n      //     });\n      //     break;\n      //   case \"Blood\":\n      //     this.edges.push({\n      //       from: \"attr_\" + attr[k][\"name\"],\n      //       to: \"blood\",\n\n      //       color: \"blue\",\n      //     });\n      //     break;\n      //   case \"CSF\":\n      //     this.edges.push({\n      //       from: \"attr_\" + attr[k][\"name\"],\n      //       to: \"spinefluid\",\n\n      //       color: \"blue\",\n      //     });\n      //     break;\n      //   case \"Ataxia\":\n      //     this.edges.push({\n      //       from: \"attr_\" + attr[k][\"name\"],\n      //       to: \"ataxia\",\n      //       color: \"blue\",\n      //     });\n      //     break;\n      //   case \"SARA scores\":\n      //     this.edges.push({\n      //       from: \"attr_\" + attr[k][\"name\"],\n      //       to: \"sara_scores\",\n      //       color: \"blue\",\n      //     });\n      //     break;\n      //   case \"SARA subscores\":\n      //     this.edges.push({\n      //       from: \"attr_\" + attr[k][\"name\"],\n      //       to: \"sara_subscores\",\n      //       color: \"blue\",\n      //     });\n      //     break;\n      //   case \"SARA\":\n      //     this.edges.push({\n      //       from: \"attr_\" + attr[k][\"name\"],\n      //       to: \"sara\",\n      //       color: \"blue\",\n      //     });\n      //     break;\n\n      //   default:\n      //     console.log(\"No topic found...\");\n      //}\n    }\n\n    var sources = sources_all[\"data\"][\"sources\"];\n    //console.log(response);\n    for (var s = 0; s < sources.length; s++) {\n      this.nodes.push({\n        id: \"sources_\" + sources[s],\n        label: sources[s],\n        cid: sources[s],\n        fixed: true,\n        color: {\n          background: \"#c2ad4b\",\n          border: \"#c2ad4b\"\n        },\n        highlight: \"red\",\n        font: { color: \"black\" },\n      });\n      //TODO add edges\n    }\n    this.sources_all = Array.from(sources);\n    this.topics_all = Array.from(topics);\n\n    var attribute_mappings = attr_mappings[\"data\"][\"mappings\"];\n    for (var d = 0; d < attribute_mappings.length; d++) {\n      if (\n        !this.nodes.some(\n          (node) => node.id == \"attr_\" + attribute_mappings[d][\"name\"]\n        )\n      ) {\n        this.nodes.push({\n          id: \"attr_\" + attribute_mappings[d][\"name\"],\n          cid: attribute_mappings[d][\"Source\"],\n          label: attribute_mappings[d][\"name\"],\n          color: {\n            background: \"#00bcbd\",\n            border: \"#00bcbd\",\n            highlight: {\n              background: \"red\",\n            },\n          },\n\n          font: { color: \"black\" },\n        });\n      }\n      if (\n        // check if edge is already set and if not self-map is set\n        !this.edges.some(\n          (edge) =>\n            edge.from == \"attr_\" + attribute_mappings[d][\"name\"] &&\n            edge.to == \"attr_\" + attribute_mappings[d][\"Target\"]\n        ) &&\n        \"attr_\" + attribute_mappings[d][\"name\"] !=\n          \"attr_\" + attribute_mappings[d][\"Target\"]\n      ) {\n        this.edges.push({\n          from: \"attr_\" + attribute_mappings[d][\"name\"],\n          to: \"attr_\" + attribute_mappings[d][\"Target\"],\n\n          color: \"blue\",\n        });\n      }\n      this.edges.push({\n        to: \"sources_\" + attribute_mappings[d][\"Source\"],\n        from: \"attr_\" + attribute_mappings[d][\"name\"],\n        color: \"grey\",\n        dashes: true\n      });\n    }\n    document.getElementById(\"fulltext_form\").onsubmit = function (e) {\n      e.preventDefault();\n      alert(\"Not implemented yet...\");\n    };\n    // align fixed nodes on unit circle:\n    var _topics = this.nodes.filter((elem) => {\n      return elem.fixed && elem.id != \"root\" && !elem.id.startsWith(\"sources_\");\n    });\n    var _sources = this.nodes.filter((elem) => {\n      return elem.fixed && elem.id.startsWith(\"sources_\");\n    });\n    console.log(_sources);\n\n\n\n\n    var _z = _sources.length;\n    _sources.forEach((s, l) => {\n      s.x = Math.round(Math.cos((2 * Math.PI * l) / _z) * 500);\n      s.y = Math.round(Math.sin((2 * Math.PI * l) / _z) * 500);\n    });\n    //console.log(_topics);\n    var _k = _topics.length;\n    _topics.forEach((t, l) => {\n      t.x = Math.round(Math.cos((2 * Math.PI * l) / _k) * 300);\n      t.y = Math.round(Math.sin((2 * Math.PI * l) / _k) * 300);\n    });\n  },\n  data() {\n    return {\n      helpText: \"The Datamodel Explorer gives insight about the variables contained in the CCDM (Common Clinical Datamodel) \"+\n      \"You can inspect single nodes by right click or search through the graph via the node search or more advanced the fulltext search. Each edge represents the ralationship between two nodes.\"\n      + \" Physics can be enabled and disabled at anytime.\",\n      update: true,\n      topics_dict: {\"Demography\": \"Master\", \n               \"Organizational\": \"Master\", \n               \"Demetia_biomarker\": \"Master\", \n               \"Demographics\": \"Master\",\n               \"Diagnosis\": \"Master\", \n               \"Family\": \"Master\", \n               \"BNT\": \"NPT\", \n               \"FAQ\": \"NPT\", \n               \"TMT\": \"NPT\", \n               \"CDR\": \"NPT\", \n               \"MOCA\": \"NPT\", \n               \"GDS\": \"NPT\", \n               \"NPI\": \"NPT\", \n               \"NPIQ\": \"NPT\", \n               \"Memory deficit\": \"Deficits\", \n               \"Language deficits\": \"Deficits\", \n               \"Executive deficits\": \"Deficits\", \n               \"Attention deficits\": \"Deficits\", \n               \"Other deficits\": \"Deficits\", \n               \"Blood\": \"Lab\", \n               \"CSF\": \"Lab\", \n               \"Ataxia\": \"Ataxia\",\n               \"SARA scores\": \"SARA\",\n               \"Dementia\": \"Dementia\"   \n                                      },\n      nodes: [\n        {\n          id: \"root\",\n          label: \"The Data Model Root\",\n          color: {\n            background: \"#c55e2d\",\n            border: \"#c55e2d\"\n          },\n          fixed: true,\n          x: 0,\n          y: 0,\n          font: { color: \"white\" },\n        },\n        // {\n        //   id: \"site\",\n        //   label: \"SITE\",\n        //   color: \"DarkViolet\",\n        //   fixed: true,\n\n        //   font: { color: \"white\" },\n        // },\n        // {\n        //   id: \"pid\",\n        //   label: \"PID\",\n        //   color: \"DarkViolet\",\n        //   fixed: true,\n\n        //   font: { color: \"white\" },\n        // },\n        // {\n        //   id: \"ts\",\n        //   label: \"TIMESTAMP\",\n        //   fixed: true,\n\n        //   color: \"DarkViolet\",\n        //   font: { color: \"white\" },\n        // },\n        // {\n        //   id: \"singular\",\n        //   label: \"Singular Patient information\",\n        //   //cid: \"master\",\n        //   color: \"DarkViolet\",\n        //   fixed: true,\n\n        //   font: { color: \"white\" },\n        // },\n        // {\n        //   id: \"blood\",\n        //   label: \"Laboratory measurements in blood\",\n        //   //cid: \"Blood\",\n        //   fixed: true,\n\n        //   color: \"DarkViolet\",\n        //   font: { color: \"white\" },\n        // },\n        // {\n        //   id: \"spinefluid\",\n        //   label: \"Laboratory measurements in cerebral spine fluid\",\n        //   //cid: \"CSF\",\n        //   color: \"DarkViolet\",\n        //   fixed: true,\n\n        //   font: { color: \"white\" },\n        // },\n        // {\n        //   id: \"neurotest\",\n        //   label: \"Neuropsychological test scores\",\n        //   color: \"DarkViolet\",\n        //   //cid: \"NPT\",\n        //   fixed: true,\n\n        //   font: { color: \"white\" },\n        // },\n        // {\n        //   id: \"qualifneurotest\",\n        //   label: \"Qualifiable neuropsychological disturbances\",\n        //   color: \"DarkViolet\",\n        //   //cid: \"Disturbances\",\n        //   fixed: true,\n\n        //   font: { color: \"white\" },\n        // },\n        // {\n        //   id: \"ataxia\",\n        //   label: \"Ataxia\",\n        //   color: \"DarkViolet\",\n        //   fixed: true,\n\n        //   font: { color: \"white\" },\n        // },\n        // {\n        //   id: \"sara\",\n        //   label: \"SARA\",\n        //   color: \"DarkViolet\",\n        //   fixed: true,\n\n        //   font: { color: \"white\" },\n        // },\n        // {\n        //   id: \"sara_subscores\",\n        //   label: \"SARA Subscores\",\n        //   color: \"DarkViolet\",\n        //   fixed: true,\n\n        //   font: { color: \"white\" },\n        // },\n        // {\n        //   id: \"sara_scores\",\n        //   label: \"SARA Scores\",\n        //   color: \"DarkViolet\",\n        //   fixed: true,\n\n        //   font: { color: \"white\" },\n        // },\n        // // ,{\n        // //   id:\"sca_characterization\",\n        // //   label: \"SCA CHARACTERIZATION\",\n        // //   fixed: true,\n        // //   x: -210,\n        // //   y: -110,\n        // //   font: { color: \"white\" },\n        // // }\n      ],\n      edges: [\n        // { from: \"site\", to: \"root\", color: \"blue\" },\n        // { from: \"spinefluid\", to: \"root\", color: \"blue\" },\n        // { from: \"pid\", to: \"root\", color: \"blue\" },\n        // { from: \"ts\", to: \"root\", color: \"blue\" },\n        // { from: \"blood\", to: \"root\", color: \"blue\" },\n        // { from: \"neurotest\", to: \"root\", color: \"blue\" },\n        // { from: \"singular\", to: \"root\", color: \"blue\" },\n        // { from: \"qualifneurotest\", to: \"root\", color: \"blue\" },\n      ],\n      menuView: \"\",\n      options: {\n        nodes: {\n          borderWidth: 4,\n          color: {\n            highlight: {\n              background: \"red\",\n            },\n          },\n        },\n        edges: {\n          color: \"lightgray\",\n\n          arrows: {\n            to: { enabled: true, scaleFactor: 1, type: \"arrow\" },\n          },\n        },\n        height: (window.innerHeight * 0.9).toString(),\n        width: (window.innerWidth * 0.99).toString(),\n\n        physics: {\n          enabled: true,\n          solver: \"barnesHut\",\n        },\n        manipulation: true,\n      },\n      sub_nodes: [],\n      sub_edges: [],\n      sub_options: {\n        nodes: {\n          borderWidth: 4,\n        },\n        edges: {\n          color: \"black\",\n\n          arrows: {\n            to: { enabled: true, scaleFactor: 1, type: \"arrow\" },\n          },\n        },\n        height: (window.innerHeight * 0.5).toString(),\n        physics: {\n          enabled: true,\n          solver: \"barnesHut\",\n        },\n      },\n    };\n  },\n  updated() {\n    const this_nodes = this.nodes;\n    const network = this.$refs.network;\n    function selectThisNode(nodeId) {\n      var findNodesReturn = network.findNode(nodeId);\n      if (network.isCluster(findNodesReturn[0])) {\n        network.openCluster(findNodesReturn[0]);\n        return selectThisNode();\n      }\n      network.focus(nodeId);\n      network.selectNodes([nodeId], [true]);\n      return;\n    }\n    if (this.update) {\n      document.getElementById(\"loader_text\").innerHTML = \"Clustering Nodes...\";\n      console.log(\"UPDATING..\");\n\n      // NETWORK PROPERTIES\n      //console.log(this.topics_all);\n\n      // CORE CLUSTERING\n      // var options_core = {\n      //   joinCondition: function (nodeOptions) {\n      //     return nodeOptions.cid === \"core\";\n      //   },\n      //   clusterNodeProperties: {\n      //     id: \"cidCluster\",\n      //     borderWidth: 3,\n      //     shape: \"circle\",\n      //     label: \"Core Model\",\n      //   },\n      // };\n\n      // this.$refs.network.cluster(options_core);\n\n      // CLUSTERING via TOPICS\n\n      var options_topics = [];\n      this.topics_all.forEach(function (topic) {\n        var options_topic = {\n          joinCondition: function (nodeOptions) {\n            //console.log(\"HALLOHALLO\");\n            return nodeOptions.cid == topic;\n          },\n          clusterNodeProperties: {\n            id: \"cidCluster_\" + topic,\n            borderWidth: 3,\n            shape: \"square\",\n            color: {\n              background: \"#1d6e88\",\n              border: \"#1d6e88\"\n            },\n            label: topic,\n          },\n        };\n        options_topics.push(options_topic);\n        // console.log(topic + \" clustering...\");\n        // this.$refs.network.cluster(options_topic);\n      });\n      for (var i = 0; i < options_topics.length; i++) {\n        this.$refs.network.cluster(options_topics[i]);\n      }\n\n      // CLUSTERING via SOURCES\n\n      var options_sources = [];\n      this.sources_all.forEach(function (source) {\n        var options_source = {\n          joinCondition: function (nodeOptions) {\n            //console.log(\"HALLOHALLO\");\n            return nodeOptions.cid == source;\n          },\n          clusterNodeProperties: {\n            id: \"cidCluster_\" + source,\n            borderWidth: 3,\n            shape: \"square\",\n            label: source,\n            color: {\n              background: \"#c2ad4b\",\n              border: \"#c2ad4b\"\n            },\n          },\n        };\n        options_sources.push(options_source);\n        // console.log(topic + \" clustering...\");\n        // this.$refs.network.cluster(options_topic);\n      });\n      for (var p = 0; p < options_sources.length; p++) {\n        this.$refs.network.cluster(options_sources[p]);\n      }\n\n      let autoCompleteData = {};\n      this.nodes.forEach((node) => {\n        autoCompleteData[node.label] = null;\n      });\n\n      var autoCompleteOptions = {\n        data: autoCompleteData,\n        onAutocomplete: function (params) {\n          var node = this_nodes.find((node) => {\n            return node.label == params;\n          });\n\n          selectThisNode(node.id);\n        },\n      };\n\n      var elems = document.querySelectorAll(\".autocomplete\");\n      M.Autocomplete.init(elems, autoCompleteOptions);\n\n      document.getElementById(\"loader\").style = \"display: none\";\n\n      document.getElementById(\"network_div\").style = \"visibility: visible\";\n\n      //this.edges = [...new Set(this.edges)];\n\n      //console.log(this.$refs.network);\n      // CLUSTERING\n      this.update = false;\n    } else {\n      console.log(\"prevented updating...\");\n    }\n  },\n};\n</script>\n<style scoped>\n.btn.waves-effect {\n  height: auto !important;\n\n  min-height: 20px;\n  line-height: 20px;\n  padding-top: 8px;\n  padding-bottom: 8px;\n}\n.waves-effect.btn {\n  height: auto !important;\n\n  min-height: 20px;\n  line-height: 20px;\n  padding-top: 8px;\n  padding-bottom: 8px;\n}\n\n.btn {\n  height: auto !important;\n}\n\n.menu {\n  background-color: white;\n  z-index: 999999;\n  width: 120px;\n  box-shadow: 0 4px 5px 3px rgba(0, 0, 0, 0.2);\n  position: absolute;\n  display: none;\n}\n.menu .menu-options {\n  list-style: none;\n  padding: 10px 0;\n}\n.menu .menu-options .menu-option {\n  font-weight: 500;\n  font-size: 14px;\n  padding: 10px 40px 10px 20px;\n  cursor: pointer;\n}\n.menu .menu-options .menu-option:hover {\n  background: rgba(0, 0, 0, 0.2);\n  cursor: pointer;\n}\nli .menu-option:hover {\n  cursor: pointer;\n}\n\n.mynetwork{\n  border: 2px solid black;\n  margin-left:5px; \n  margin-right: 5px;\n  margin-bottom: 10px\n\n}\n\n</style>"]}]}